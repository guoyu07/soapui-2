{
  Settings settings=SoapUI.getSettings();
  boolean disableAnalytics=settings.getBoolean(UISettings.DISABLE_ANALYTICS,true);
  if (!disableAnalytics) {
    return false;
  }
  Version optOutVersion=new Version(settings.getString(UISettings.ANALYTICS_OPT_OUT_VERSION,"0.0"));
  Version currentSoapUIVersion=new Version(SoapUI.SOAPUI_VERSION);
  if (!optOutVersion.getMajorVersion().equals(currentSoapUIVersion.getMajorVersion())) {
    disableAnalytics=JOptionPane.showConfirmDialog(null,"Do you want to help us improve SoapUI by sending anonymous usage statistics?","Usage statistics",JOptionPane.YES_NO_OPTION) == JOptionPane.NO_OPTION;
    settings.setBoolean(UISettings.DISABLE_ANALYTICS,disableAnalytics);
  }
  if (disableAnalytics) {
    settings.setString(UISettings.ANALYTICS_OPT_OUT_VERSION,currentSoapUIVersion.getMajorVersion());
  }
  return disableAnalytics;
}
