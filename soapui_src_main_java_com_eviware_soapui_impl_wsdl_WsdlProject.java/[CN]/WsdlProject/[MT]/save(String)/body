{
  if (!isOpen() || isDisabled() || isRemote()) {
    return SaveStatus.SUCCESS;
  }
  if (!hasBeenSavedBefore()) {
    String tempPath=StringUtils.createFileName2(getName(),'-') + "-soapui-project.xml";
    if (folder != null) {
      tempPath=folder + File.separatorChar + tempPath;
    }
    File file=null;
    while (file == null || (file.exists() && !UISupport.confirm("File [" + file.getName() + "] exists, overwrite?","Overwrite File?"))) {
      file=UISupport.getFileDialogs().saveAs(this,"Save project " + getName(),".xml","XML Files (*.xml)",new File(tempPath));
      if (file == null) {
        return SaveStatus.CANCELLED;
      }
    }
    path=file.getAbsolutePath();
  }
  File projectFile=new File(path);
  while (projectFile.exists() && !projectFile.canWrite()) {
    if (UISupport.confirm("Project file [" + path + "] can not be written to, save to new file?","Save Project")) {
      projectFile=UISupport.getFileDialogs().saveAs(this,"Save project " + getName(),".xml","XML Files (*.xml)",projectFile);
      if (projectFile == null)       return SaveStatus.CANCELLED;
      path=projectFile.getAbsolutePath();
    }
 else {
      return SaveStatus.CANCELLED;
    }
  }
  if (projectFileModified(projectFile)) {
    if (!UISupport.confirm("Project file for [" + getName() + "] has been modified externally, overwrite?","Save Project")) {
      return SaveStatus.DONT_SAVE;
    }
  }
  if (projectFile.exists() && getSettings().getBoolean(UISettings.CREATE_BACKUP)) {
    createBackup(projectFile);
  }
  return saveIn(projectFile);
}
