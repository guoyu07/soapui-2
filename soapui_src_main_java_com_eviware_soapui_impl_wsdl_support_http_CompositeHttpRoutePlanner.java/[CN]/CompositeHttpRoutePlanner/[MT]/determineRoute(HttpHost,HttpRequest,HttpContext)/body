{
  Object manualProxy=request.getParams().getParameter(ConnRoutePNames.DEFAULT_PROXY);
  if (manualProxy == null && autoProxyEnabled) {
    ProxySelector proxySelector=getProxySelector().getProxySelector();
    if (proxySelector != null) {
      return new ProxySelectorRoutePlanner(registry,proxySelector).determineRoute(target,request,context);
    }
  }
  return defaultHttpRoutePlanner.determineRoute(target,request,context);
}
