{
  Set<ApiImporter> importers=new HashSet<ApiImporter>(PluginProxies.proxyInstancesWhereApplicable(plugin.getApiImporters()));
  if (autoDetect) {
    Set<Class<?>> apiImporterClasses=jarFileScanner.getTypesAnnotatedWith(PluginApiImporter.class);
    for (    Class<?> apiImporterClass : apiImporterClasses) {
      if (ApiImporter.class.isAssignableFrom(apiImporterClass)) {
        try {
          importers.add((ApiImporter)createObject(apiImporterClass));
        }
 catch (        Exception e) {
          throw new InvalidPluginException("Couldn't instantiate API Importer from class " + apiImporterClass,e);
        }
      }
 else {
        throw new InvalidPluginException("API Importer class " + apiImporterClass + " doesn't implement ApiImporter");
      }
    }
  }
  return importers;
}
