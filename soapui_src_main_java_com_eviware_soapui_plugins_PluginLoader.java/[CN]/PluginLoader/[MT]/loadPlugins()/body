{
  File[] pluginFiles=pluginDirectory.listFiles();
  if (pluginFiles != null) {
    for (    File pluginFile : pluginFiles) {
      log.info("Adding plugin from [" + pluginFile.getAbsolutePath() + "]");
      try {
        Plugin plugin=loadPluginFrom(pluginFile);
        if (plugin == null) {
          loadOldStylePluginFrom(pluginFile);
        }
 else {
          installedPlugins.put(pluginFile,plugin);
        }
      }
 catch (      IOException e) {
        log.warn("Could not load plugin from file [" + pluginFile + "]");
      }
    }
  }
}
