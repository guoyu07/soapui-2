{
  File[] pluginFiles=new File("plugins").listFiles();
  if (pluginFiles != null) {
    for (    File pluginFile : pluginFiles) {
      if (!pluginFile.getName().toLowerCase().endsWith(".jar"))       continue;
      try {
        log.info("Adding plugin from [" + pluginFile.getAbsolutePath() + "]");
        extensionClassLoader.addFile(pluginFile);
        JarFile jarFile=new JarFile(pluginFile);
        JarEntry entry=jarFile.getJarEntry("META-INF/factories.xml");
        if (entry != null)         factoryRegistry.addConfig(jarFile.getInputStream(entry),extensionClassLoader);
        entry=jarFile.getJarEntry("META-INF/listeners.xml");
        if (entry != null)         listenerRegistry.addConfig(jarFile.getInputStream(entry),extensionClassLoader);
        entry=jarFile.getJarEntry("META-INF/actions.xml");
        if (entry != null)         actionRegistry.addConfig(jarFile.getInputStream(entry),extensionClassLoader);
        UISupport.addResourceClassLoader(new URLClassLoader(new URL[]{pluginFile.toURI().toURL()}));
      }
 catch (      Exception e) {
        SoapUI.logError(e);
      }
    }
  }
}
