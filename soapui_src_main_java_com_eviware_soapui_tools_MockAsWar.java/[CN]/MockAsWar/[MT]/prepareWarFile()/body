{
  if (createWarFileSystem()) {
    File fromDir=new File(System.getProperty(SOAPUI_HOME),".." + File.separator + "lib");
    JarPackager.copyAllFromTo(fromDir,lib,new CaseInsensitiveFileFilter());
    if (includeExt) {
      String extDirPath=System.getProperty("soapui.ext.libraries");
      fromDir=extDirPath != null ? new File(extDirPath) : new File(new File(System.getProperty(SOAPUI_HOME)),"ext");
      JarPackager.copyAllFromTo(fromDir,lib,null);
    }
    File soapUIHome=new File(System.getProperty(SOAPUI_HOME));
    String[] mainJar=soapUIHome.list(new FilenameFilter(){
      public boolean accept(      File dir,      String name){
        return name.toLowerCase().startsWith("soapui") && name.toLowerCase().endsWith(".jar");
      }
    }
);
    fromDir=new File(System.getProperty(SOAPUI_HOME),mainJar[0]);
    JarPackager.copyFileToDir(fromDir,lib);
    copyProjectFile();
    if (settingsFile != null && settingsFile.exists() && settingsFile.isFile()) {
      JarPackager.copyFileToDir(settingsFile,soapuiDir);
    }
    if (includeActions) {
      fromDir=new File(System.getProperty("soapui.ext.actions"));
      JarPackager.copyAllFromTo(fromDir,actionsDir,null);
    }
    if (includeListeners) {
      fromDir=new File(System.getProperty("soapui.ext.listeners"));
      JarPackager.copyAllFromTo(fromDir,listenersDir,null);
    }
    copyWarResource("header_logo.png");
    copyWarResource("stylesheet.css");
    return true;
  }
  return false;
}
