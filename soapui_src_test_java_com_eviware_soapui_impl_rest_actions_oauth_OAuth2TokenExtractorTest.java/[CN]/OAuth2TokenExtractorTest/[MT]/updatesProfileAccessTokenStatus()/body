{
  final List<String> statusValues=new ArrayList<String>();
  profile.addPropertyChangeListener(OAuth2Profile.ACCESS_TOKEN_STATUS_PROPERTY,new PropertyChangeListener(){
    @Override public void propertyChange(    PropertyChangeEvent evt){
      statusValues.add((String)evt.getNewValue());
    }
  }
);
  oAuth2TokenExtractor.extractAccessTokenForAuthorizationCodeGrantFlow(parameters);
  assertThat(statusValues.size(),is(3));
  assertThat(statusValues,hasItem(OAuth2Profile.AccessTokenStatus.WAITING_FOR_AUTHORIZATION.toString()));
  assertThat(statusValues,hasItem(OAuth2Profile.AccessTokenStatus.RECEIVED_AUTHORIZATION_CODE.toString()));
  assertThat(statusValues,hasItem(OAuth2Profile.AccessTokenStatus.RETRIEVED_FROM_SERVER.toString()));
}
