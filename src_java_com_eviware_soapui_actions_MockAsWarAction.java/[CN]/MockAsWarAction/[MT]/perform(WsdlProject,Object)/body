{
  if (project.getMockServiceCount() == 0) {
    UISupport.showErrorMessage("Project does not have any MockServices to deploy");
    return;
  }
  if (dialog == null) {
    dialog=ADialogBuilder.buildDialog(MockAsWarDialog.class);
    dialog.getFormField(MockAsWarDialog.GLOBAL_SETTINGS).addFormFieldListener(new XFormFieldListener(){
      public void valueChanged(      XFormField sourceField,      String newValue,      String oldValue){
        if (Boolean.valueOf(newValue))         dialog.getFormField(MockAsWarDialog.SETTINGS_FILE).setEnabled(true);
 else         dialog.getFormField(MockAsWarDialog.SETTINGS_FILE).setEnabled(false);
      }
    }
);
    dialog.getFormField(MockAsWarDialog.WAR_DIRECTORY).addFormFieldValidator(new RequiredValidator("WAR Directory is required"));
  }
  XFormField settingFile=dialog.getFormField(MockAsWarDialog.SETTINGS_FILE);
  settingFile.setValue(((DefaultSoapUICore)SoapUI.getSoapUICore()).getSettingsFile());
  settingFile.setEnabled(false);
  XFormField warDirectory=dialog.getFormField(MockAsWarDialog.WAR_DIRECTORY);
  XFormField warFile=dialog.getFormField(MockAsWarDialog.WAR_FILE);
  String passwordForEncryption=project.getSettings().getString(ProjectSettings.SHADOW_PASSWORD,null);
  project.getSettings().setString(ProjectSettings.SHADOW_PASSWORD,null);
  if (dialog.show()) {
    project.beforeSave();
    try {
      project.save();
    }
 catch (    IOException e) {
      log.error(e.getMessage(),e);
    }
 finally {
      project.getSettings().setString(ProjectSettings.SHADOW_PASSWORD,passwordForEncryption);
    }
    MockAsWar mockAsWar=new MockAsWar(project.getPath(),dialog.getBooleanValue(MockAsWarDialog.GLOBAL_SETTINGS) ? settingFile.getValue() : "",warDirectory.getValue(),warFile.getValue(),dialog.getBooleanValue(MockAsWarDialog.EXT_LIBS),dialog.getBooleanValue(MockAsWarDialog.ACTIONS),dialog.getBooleanValue(MockAsWarDialog.LISTENERS),dialog.getValue(MockAsWarDialog.MOCKSERVICE_ENDPOINT),dialog.getBooleanValue(MockAsWarDialog.ENABLE_WEBUI));
    mockAsWar.createMockAsWarArchive();
  }
}
