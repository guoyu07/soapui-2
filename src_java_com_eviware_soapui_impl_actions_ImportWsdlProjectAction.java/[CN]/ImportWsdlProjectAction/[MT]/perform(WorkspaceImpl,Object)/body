{
  File file=null;
  if (param == null) {
    String path=new File(previous == null ? workspace.getPath() : previous).getParentFile().getAbsolutePath();
    file=UISupport.getFileDialogs().open(this,messages.get("prompt.title"),"xml","soapUI Project File",path);
  }
 else {
    file=new File(param.toString());
  }
  if (file == null)   return;
  String fileName=file.getAbsolutePath();
  if (fileName == null)   return;
  previous=fileName;
  ClassLoader contextClassLoader=Thread.currentThread().getContextClassLoader();
  Thread.currentThread().setContextClassLoader(SoapUI.class.getClassLoader());
  try {
    WsdlProject project=(WsdlProject)workspace.importProject(fileName);
    if (project != null)     UISupport.select(project);
  }
 catch (  Exception ex) {
    UISupport.showErrorMessage(ex);
  }
 finally {
    Thread.currentThread().setContextClassLoader(contextClassLoader);
  }
}
