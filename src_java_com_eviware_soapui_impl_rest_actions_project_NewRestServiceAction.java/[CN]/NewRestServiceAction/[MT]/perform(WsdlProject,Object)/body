{
  if (dialog == null) {
    dialog=ADialogBuilder.buildDialog(Form.class);
    dialog.getFormField(Form.SERVICENAME).addFormFieldValidator(new RequiredValidator("Service Name is required"));
    dialog.getFormField(Form.SERVICEENDPOINT).addFormFieldListener(new XFormFieldListener(){
      public void valueChanged(      XFormField sourceField,      String newValue,      String oldValue){
        boolean enable=false;
        try {
          URL url=new URL(newValue);
          enable=url.getPath().length() > 0 && !(url.getPath().length() == 1 && url.getPath().charAt(0) == '/');
        }
 catch (        MalformedURLException e) {
        }
        dialog.getFormField(Form.EXTRACTPARAMS).setEnabled(enable);
      }
    }
);
    dialog.getFormField(Form.EXTRACTPARAMS).setEnabled(false);
    dialog.getFormField(Form.EXTRACTPARAMS).addFormFieldListener(new XFormFieldListener(){
      public void valueChanged(      XFormField sourceField,      String newValue,      String oldValue){
        dialog.getFormField(Form.CREATERESOURCE).setEnabled(!dialog.getBooleanValue(Form.EXTRACTPARAMS));
      }
    }
);
  }
 else {
    dialog.setValue(Form.SERVICEENDPOINT,"");
    dialog.setBooleanValue(Form.EXTRACTPARAMS,false);
  }
  if (param instanceof ModelItem)   dialog.setValue(Form.SERVICENAME,((ModelItem)param).getName());
 else   dialog.setValue(Form.SERVICENAME,project.getName());
  if (dialog.show()) {
    RestService restService=(RestService)project.addNewInterface(dialog.getValue(Form.SERVICENAME),RestServiceFactory.REST_TYPE);
    UISupport.select(restService);
    URL url=null;
    try {
      url=new URL(dialog.getValue(Form.SERVICEENDPOINT));
      String endpoint=url.getProtocol() + "://" + url.getHost();
      if (url.getPort() > 0)       endpoint+=":" + url.getPort();
      restService.addEndpoint(endpoint);
      restService.setBasePath(url.getPath());
    }
 catch (    Exception e) {
    }
    if (dialog.getFormField(Form.EXTRACTPARAMS).isEnabled() && dialog.getBooleanValue(Form.EXTRACTPARAMS)) {
      restService.setBasePath("");
      SoapUI.getActionRegistry().getAction(NewRestResourceAction.SOAPUI_ACTION_ID).perform(restService,url);
    }
    if (dialog.getFormField(Form.CREATERESOURCE).isEnabled() && dialog.getBooleanValue(Form.CREATERESOURCE)) {
      SoapUI.getActionRegistry().getAction(NewRestResourceAction.SOAPUI_ACTION_ID).perform(restService,null);
    }
  }
}
