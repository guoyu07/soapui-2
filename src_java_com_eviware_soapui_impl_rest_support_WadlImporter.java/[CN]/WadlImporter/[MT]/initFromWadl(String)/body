{
  try {
    XmlObject xmlObject=XmlObject.Factory.parse(new URL(wadlUrl));
    Element element=((Document)xmlObject.getDomNode()).getDocumentElement();
    if (element.getLocalName().equals("application") && element.getNamespaceURI().startsWith("http://research.sun.com/wadl") && !element.getNamespaceURI().equals(Constants.WADL10_NS)) {
      String content=xmlObject.xmlText();
      content=content.replaceAll("\"" + element.getNamespaceURI() + "\"","\"" + Constants.WADL10_NS + "\"");
      xmlObject=ApplicationDocument.Factory.parse(content);
    }
 else     if (!element.getLocalName().equals("application") || !element.getNamespaceURI().equals(Constants.WADL10_NS)) {
      throw new Exception("Document is not a WADL application with " + Constants.WADL10_NS + " namespace");
    }
    ApplicationDocument applicationDocument=(ApplicationDocument)xmlObject.changeType(ApplicationDocument.type);
    application=applicationDocument.getApplication();
    resources=application.getResources();
    service.setName(getFirstTitle(application.getDocList(),service.getName()));
    String base=resources.getBase();
    try {
      URL baseUrl=new URL(base);
      service.setBasePath(baseUrl.getPath());
      service.addEndpoint(Tools.getEndpointFromUrl(baseUrl));
    }
 catch (    Exception e) {
      service.setBasePath(base);
    }
    service.setWadlUrl(wadlUrl);
    for (    Resource resource : resources.getResourceList()) {
      String name=getFirstTitle(resource.getDocList(),resource.getPath());
      String path=resource.getPath();
      RestResource newResource=service.addNewResource(name,path);
      initResourceFromWadlResource(newResource,resource);
      addSubResources(newResource,resource);
    }
  }
 catch (  Exception e) {
    UISupport.showErrorMessage(e);
  }
}
