{
  Set<WsdlInterface> requiredInterfaces=new HashSet<WsdlInterface>();
  for (int i=0; i < testSuite.getTestCaseCount(); i++) {
    WsdlTestCase testCase=testSuite.getTestCaseAt(i);
    for (int y=0; y < testCase.getTestStepCount(); y++) {
      WsdlTestStep testStep=testCase.getTestStepAt(y);
      requiredInterfaces.addAll(testStep.getRequiredInterfaces());
    }
  }
  if (requiredInterfaces.size() > 0 && targetProject.getInterfaceCount() > 0) {
    Map<QName,WsdlInterface> bindings=new HashMap<QName,WsdlInterface>();
    for (    WsdlInterface iface : requiredInterfaces) {
      bindings.put(iface.getBindingName(),iface);
    }
    for (    Interface iface : targetProject.getInterfaceList()) {
      bindings.remove(iface.getTechnicalId());
    }
    requiredInterfaces.retainAll(bindings.values());
  }
  return requiredInterfaces;
}
