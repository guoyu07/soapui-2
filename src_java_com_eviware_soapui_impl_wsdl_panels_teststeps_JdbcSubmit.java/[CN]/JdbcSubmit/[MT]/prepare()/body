{
  JdbcRequestTestStep testStep=request.getTestStep();
  getDatabaseConnection();
  if (testStep.isStoredProcedure()) {
    String sql=PropertyExpander.expandProperties(context,testStep.getQuery());
    if (!sql.startsWith("{call ") && !sql.endsWith("}"))     sql="{call " + sql + "}";
    statement=connection.prepareCall(sql,ResultSet.TYPE_FORWARD_ONLY,ResultSet.CONCUR_READ_ONLY);
  }
 else {
    String sql=PropertyExpander.expandProperties(context,testStep.getQuery());
    statement=connection.prepareStatement(sql);
  }
  try {
    String queryTimeout=PropertyExpander.expandProperties(testStep,testStep.getQueryTimeout());
    statement.setQueryTimeout(Integer.parseInt(queryTimeout));
  }
 catch (  NumberFormatException e) {
  }
  try {
    String maxRows=PropertyExpander.expandProperties(testStep,testStep.getMaxRows());
    statement.setMaxRows(Integer.parseInt(maxRows));
  }
 catch (  NumberFormatException e) {
  }
}
