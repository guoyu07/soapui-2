{
  super(new BorderLayout());
  this.model=model;
  Settings settings=model.getSettings();
  Font editorFont=UISupport.getEditorFont(settings);
  editArea=new RSyntaxTextArea();
  editArea.restoreDefaultSyntaxHighlightingColorScheme();
  setEditorFont(editorFont);
  editArea.setSyntaxEditingStyle(RSyntaxTextArea.GROOVY_SYNTAX_STYLE);
  editArea.setBorder(BorderFactory.createMatteBorder(0,2,0,0,Color.WHITE));
  editArea.setText(model.getScript());
  editArea.setCaretPosition(0);
  editArea.setCurrentLineHighlightEnabled(false);
  Action runAction=model.getRunAction();
  if (runAction != null) {
    editArea.getInputMap().put(KeyStroke.getKeyStroke("alt ENTER"),"run-action");
    editArea.getActionMap().put("run-action",runAction);
  }
  groovyDocumentListener=new GroovyDocumentListener();
  editArea.getDocument().addDocumentListener(groovyDocumentListener);
  settingsListener=new InternalSettingsListener();
  settings.addSettingsListener(settingsListener);
  scrollPane=new RTextScrollPane(500,300,editArea,true);
  add(scrollPane);
  UISupport.addPreviewCorner(scrollPane,true);
  addFocusListener(new FocusAdapter(){
    public void focusGained(    FocusEvent e){
      editArea.requestFocusInWindow();
    }
  }
);
  RSyntaxAreaPopupMenu popup=RSyntaxAreaPopupMenu.add(editArea);
  popup.add(new FindAndReplaceDialog(new RSyntaxTextAreaFindAndReplaceable()));
  popup.addSeparator();
  popup.add(new GoToLineAction());
  toggleLineNumbersMenuItem=new JCheckBoxMenuItem("Show Line Numbers",scrollPane.areLineNumbersEnabled());
  toggleLineNumbersMenuItem.setAccelerator(UISupport.getKeyStroke("alt L"));
  toggleLineNumbersMenuItem.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      enableLineNumbers(toggleLineNumbersMenuItem.isSelected());
    }
  }
);
  editArea.getInputMap().put(KeyStroke.getKeyStroke("alt L"),new AbstractAction(){
    public void actionPerformed(    ActionEvent e){
      enableLineNumbers(!scrollPane.areLineNumbersEnabled());
    }
  }
);
  popup.add(toggleLineNumbersMenuItem);
  editArea.setComponentPopupMenu(popup);
  enableLineNumbers(settings.getBoolean(UISettings.SHOW_GROOVY_LINE_NUMBERS));
}
