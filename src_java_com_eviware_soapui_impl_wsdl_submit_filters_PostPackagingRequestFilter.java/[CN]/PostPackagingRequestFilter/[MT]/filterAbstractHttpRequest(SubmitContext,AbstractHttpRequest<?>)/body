{
  ExtendedHttpMethod httpMethod=(ExtendedHttpMethod)context.getProperty(BaseHttpRequestTransport.HTTP_METHOD);
  Settings settings=request.getSettings();
  if (httpMethod.getParams().getVersion().equals(HttpVersion.HTTP_1_1) && httpMethod instanceof EntityEnclosingMethod) {
    EntityEnclosingMethod entityEnclosingMethod=((EntityEnclosingMethod)httpMethod);
    long limit=settings.getLong(HttpSettings.CHUNKING_THRESHOLD,-1);
    RequestEntity requestEntity=entityEnclosingMethod.getRequestEntity();
    entityEnclosingMethod.setContentChunked(limit >= 0 && requestEntity != null ? requestEntity.getContentLength() > limit : false);
  }
}
