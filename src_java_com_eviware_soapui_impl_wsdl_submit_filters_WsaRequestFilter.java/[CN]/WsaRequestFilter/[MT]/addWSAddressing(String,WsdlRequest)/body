{
  try {
    SoapVersion soapVersion=wsdlRequest.getOperation().getInterface().getSoapVersion();
    String wsaVersionNameSpace="http://www.w3.org/2005/08/addressing";
    if (wsdlRequest.getWsaConfig().getVersion().equals(WsaVersionTypeConfig.X_200408.toString())) {
      wsaVersionNameSpace="http://schemas.xmlsoap.org/ws/2004/08/addressing";
    }
    XmlObject xmlObject=XmlObject.Factory.parse(content);
    Element header=(Element)SoapUtils.getHeaderElement(xmlObject,soapVersion,true).getDomNode();
    header.setAttribute("xmlns:wsa",wsaVersionNameSpace);
    XmlObject[] envelope=xmlObject.selectChildren(soapVersion.getEnvelopeQName());
    Element elm=(Element)envelope[0].getDomNode();
    Boolean mustUnderstand=null;
    if (!wsdlRequest.getWsaConfig().getMustUnderstand().equals(MustUnderstandTypeConfig.NONE.toString())) {
      mustUnderstand=true;
    }
    WsaBuilder builder=new WsaBuilder(header,soapVersion,wsaVersionNameSpace,mustUnderstand);
    header.appendChild(builder.createWsaChildElement("wsa:Action",elm,wsdlRequest.getWsaConfig().getAction()));
    String from=wsdlRequest.getWsaConfig().getFrom();
    if (from != null && !from.isEmpty()) {
      header.appendChild(builder.createWsaChildElement("wsa:from",elm,from));
    }
    String replyTo=wsdlRequest.getWsaConfig().getReplyTo();
    if (replyTo != null && !replyTo.isEmpty()) {
      header.appendChild(builder.createWsaChildElement("wsa:replyTo",elm,replyTo));
    }
    String faultTo=wsdlRequest.getWsaConfig().getFaultTo();
    if (faultTo != null && !faultTo.isEmpty()) {
      header.appendChild(builder.createWsaChildElement("wsa:faultToTo",elm,faultTo));
    }
    String msgId=wsdlRequest.getWsaConfig().getMessageID();
    if (msgId != null && !msgId.isEmpty()) {
      header.appendChild(builder.createWsaChildElement("wsa:MessageID",elm,msgId));
    }
    content=xmlObject.xmlText();
  }
 catch (  Exception e) {
    SoapUI.logError(e);
  }
  return content;
}
