{
  TopicConnectionFactory topcConnectionFactory=null;
  TopicConnection topicConnection=null;
  TopicSession topicSession=null;
  ConnectionFactory connectionFactory=null;
  Connection connection=null;
  Session session=null;
  JMSResponse response=null;
  try {
    String topicNamePublish=null;
    String queueNameReceive=null;
    String sessionName=null;
    String[] parameters=request.getEndpoint().substring(request.getEndpoint().indexOf("://") + 3).split("/");
    if (parameters.length == 3) {
      sessionName=PropertyExpander.expandProperties(submitContext,parameters[0]);
      topicNamePublish=PropertyExpander.expandProperties(submitContext,parameters[1]).replaceFirst("topic_","");
      queueNameReceive=PropertyExpander.expandProperties(submitContext,parameters[2]).replaceFirst("queue_","");
    }
 else     throw new Exception("bad jms alias!!!!!");
    submitContext.setProperty(HERMES_SESSION_NAME,sessionName);
    Hermes hermes=getHermes(sessionName,request);
    topcConnectionFactory=(TopicConnectionFactory)hermes.getConnectionFactory();
    connectionFactory=(ConnectionFactory)hermes.getConnectionFactory();
    topicConnection=topcConnectionFactory.createTopicConnection();
    topicConnection.start();
    connection=connectionFactory.createConnection();
    connection.start();
    topicSession=topicConnection.createTopicSession(false,Session.AUTO_ACKNOWLEDGE);
    session=connection.createSession(false,Session.AUTO_ACKNOWLEDGE);
    Topic topicPublish=(Topic)hermes.getDestination(topicNamePublish,Domain.TOPIC);
    Queue queueReceive=(Queue)hermes.getDestination(queueNameReceive,Domain.QUEUE);
    TopicPublisher messageProducer=topicSession.createPublisher(topicPublish);
    TextMessage textMessagePublish=topicSession.createTextMessage();
    String messageBody=PropertyExpander.expandProperties(submitContext,request.getRequestContent());
    textMessagePublish.setText(messageBody);
    JMSHeader jmsHeader=new JMSHeader();
    jmsHeader.setMessageHeaders(textMessagePublish,request,hermes,submitContext);
    JMSHeader.setMessageProperties(textMessagePublish,request,hermes,submitContext);
    messageProducer.send(textMessagePublish,textMessagePublish.getJMSDeliveryMode(),textMessagePublish.getJMSPriority(),jmsHeader.getTimeTolive());
    submitContext.setProperty(JMS_MESSAGE_SEND,textMessagePublish);
    MessageConsumer messageConsumer=session.createConsumer(queueReceive);
    long timeout=getTimeout(submitContext,request);
    Message messageReceive=messageConsumer.receive(timeout);
    if (messageReceive != null) {
      TextMessage textMessageReceive=null;
      if (messageReceive instanceof TextMessage) {
        textMessageReceive=(TextMessage)messageReceive;
      }
      response=new JMSResponse(textMessageReceive.getText(),textMessagePublish,textMessageReceive,request,timeStarted);
      submitContext.setProperty(JMS_MESSAGE_RECEIVE,messageReceive);
      submitContext.setProperty(JMS_RESPONSE,response);
      return response;
    }
 else {
      return new JMSResponse("",null,null,request,timeStarted);
    }
  }
 catch (  JMSException jmse) {
    SoapUI.logError(jmse);
    submitContext.setProperty(JMS_ERROR,jmse);
    response=new JMSResponse("",null,null,request,timeStarted);
    submitContext.setProperty(JMS_RESPONSE,response);
    return response;
  }
catch (  Throwable t) {
    SoapUI.logError(t);
  }
 finally {
    if (topicSession != null)     topicSession.close();
    if (topicConnection != null)     topicConnection.close();
    if (session != null)     session.close();
    if (connection != null)     connection.close();
  }
  return null;
}
