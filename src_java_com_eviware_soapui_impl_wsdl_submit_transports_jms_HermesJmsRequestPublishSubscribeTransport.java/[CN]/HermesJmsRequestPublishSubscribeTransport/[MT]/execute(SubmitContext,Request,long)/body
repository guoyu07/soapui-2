{
  TopicConnectionFactory topicConnectionFactory=null;
  TopicConnection topicConnection=null;
  TopicSession topicSession=null;
  TopicSubscriber topicDurableSubsriber=null;
  try {
    JMSEndpoint jmsEndpoint=new JMSEndpoint(request,submitContext);
    submitContext.setProperty(HERMES_SESSION_NAME,jmsEndpoint.getSessionName());
    Hermes hermes=getHermes(jmsEndpoint.getSessionName(),request);
    topicConnectionFactory=(TopicConnectionFactory)hermes.getConnectionFactory();
    topicConnection=(TopicConnection)createConnection(submitContext,request,topicConnectionFactory,Domain.TOPIC,jmsEndpoint.getSessionName() + "-" + jmsEndpoint.getReceive());
    topicConnection.start();
    topicSession=topicConnection.createTopicSession(false,Session.AUTO_ACKNOWLEDGE);
    Topic topicPublish=(Topic)hermes.getDestination(jmsEndpoint.getSend(),Domain.TOPIC);
    Topic topicSubscribe=(Topic)hermes.getDestination(jmsEndpoint.getReceive(),Domain.TOPIC);
    topicDurableSubsriber=topicSession.createDurableSubscriber(topicSubscribe,"durableSubscription" + jmsEndpoint.getReceive());
    Message messagePublish=messagePublish(submitContext,request,topicSession,hermes,topicPublish);
    return makeResponse(submitContext,request,timeStarted,messagePublish,topicDurableSubsriber);
  }
 catch (  JMSException jmse) {
    return errorResponse(submitContext,request,timeStarted,jmse);
  }
catch (  Throwable t) {
    SoapUI.logError(t);
  }
 finally {
    if (topicDurableSubsriber != null)     topicDurableSubsriber.close();
    closeSessionAndConnection(topicConnection,topicSession);
  }
  return null;
}
