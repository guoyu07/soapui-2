{
  TopicConnectionFactory connectionFactory=null;
  TopicConnection connection=null;
  TopicSession session=null;
  JMSResponse response=null;
  try {
    String topicName=null;
    String sessionName=null;
    String[] parameters=request.getEndpoint().substring(request.getEndpoint().indexOf("://") + 3).split("/");
    if (parameters.length == 2) {
      sessionName=PropertyExpander.expandProperties(submitContext,parameters[0]);
      topicName=PropertyExpander.expandProperties(submitContext,parameters[1]).replaceFirst("topic_","");
    }
 else     throw new UnresolvedJMSEndpointException("bad jms alias!!!!!");
    submitContext.setProperty(HERMES_SESSION_NAME,sessionName);
    Hermes hermes=getHermes(sessionName,request);
    connectionFactory=(TopicConnectionFactory)hermes.getConnectionFactory();
    connection=connectionFactory.createTopicConnection();
    connection.start();
    session=connection.createTopicSession(false,Session.AUTO_ACKNOWLEDGE);
    Topic topic=(Topic)hermes.getDestination(topicName,Domain.TOPIC);
    TopicPublisher messageProducer=session.createPublisher(topic);
    TextMessage textMessage=session.createTextMessage();
    String messageBody=PropertyExpander.expandProperties(submitContext,request.getRequestContent());
    textMessage.setText(messageBody);
    JMSHeader jmsHeader=new JMSHeader();
    jmsHeader.setMessageHeaders(textMessage,request,hermes,submitContext);
    JMSHeader.setMessageProperties(textMessage,request,hermes,submitContext);
    messageProducer.send(textMessage,textMessage.getJMSDeliveryMode(),textMessage.getJMSPriority(),jmsHeader.getTimeTolive());
    response=new JMSResponse("",null,request,timeStarted);
    submitContext.setProperty(JMS_MESSAGE,textMessage);
    submitContext.setProperty(JMS_RESPONSE,response);
    return response;
  }
 catch (  Throwable jmse) {
    SoapUI.logError(jmse);
    submitContext.setProperty(JMS_ERROR,jmse);
    response=new JMSResponse("",null,request,timeStarted);
    submitContext.setProperty(JMS_RESPONSE,response);
    return response;
  }
 finally {
    if (session != null)     session.close();
    if (connection != null)     connection.close();
  }
}
