{
  QueueConnectionFactory queueConnectionFactory=null;
  QueueConnection queueConnection=null;
  QueueSession queueSession=null;
  try {
    JMSEndpoint jmsEndpoint=new JMSEndpoint(request,submitContext);
    submitContext.setProperty(HERMES_SESSION_NAME,jmsEndpoint.getSessionName());
    Hermes hermes=getHermes(jmsEndpoint.getSessionName(),request);
    queueConnectionFactory=(javax.jms.QueueConnectionFactory)hermes.getConnectionFactory();
    queueConnection=(QueueConnection)createConnection(submitContext,request,queueConnectionFactory,Domain.QUEUE,null);
    queueConnection.start();
    queueSession=queueConnection.createQueueSession(false,Session.AUTO_ACKNOWLEDGE);
    Queue queueSend=(Queue)hermes.getDestination(jmsEndpoint.getSend(),Domain.QUEUE);
    Queue queueReceive=(Queue)hermes.getDestination(jmsEndpoint.getReceive(),Domain.QUEUE);
    Message messageSend=messageSend(submitContext,request,queueSession,hermes,queueSend);
    MessageConsumer messageConsumer=queueSession.createConsumer(queueReceive);
    return makeResponse(submitContext,request,timeStarted,messageSend,messageConsumer);
  }
 catch (  JMSException jmse) {
    return errorResponse(submitContext,request,timeStarted,jmse);
  }
catch (  Throwable t) {
    SoapUI.logError(t);
  }
 finally {
    closeSessionAndConnection(queueConnection,queueSession);
  }
  return null;
}
