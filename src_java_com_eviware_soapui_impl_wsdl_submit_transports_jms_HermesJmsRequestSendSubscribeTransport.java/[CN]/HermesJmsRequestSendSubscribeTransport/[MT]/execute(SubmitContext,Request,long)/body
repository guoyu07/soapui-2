{
  TopicSession topicSession=null;
  QueueSession queueSession=null;
  TopicSubscriber topicSubsriber=null;
  JMSConnectionHolder jmsConnectionHolder=null;
  try {
    init(submitContext,request);
    String clientIDString=StringUtils.hasContent(clientID) ? clientID : jmsEndpoint.getSessionName() + "-" + jmsEndpoint.getReceive();
    jmsConnectionHolder=new JMSConnectionHolder(jmsEndpoint,hermes,true,true,clientIDString,username,password);
    topicSession=jmsConnectionHolder.getTopicSession();
    queueSession=jmsConnectionHolder.getQueueSession();
    Queue queueSend=jmsConnectionHolder.getQueue(jmsConnectionHolder.getJmsEndpoint().getSend());
    Topic topicReceive=jmsConnectionHolder.getTopic(jmsConnectionHolder.getJmsEndpoint().getReceive());
    topicSubsriber=topicSession.createDurableSubscriber(topicReceive,StringUtils.hasContent(durableSubscriptionName) ? durableSubscriptionName : "durableSubscription" + jmsConnectionHolder.getJmsEndpoint().getReceive());
    Message textMessageSend=messageSend(submitContext,request,queueSession,jmsConnectionHolder.getHermes(),queueSend);
    return makeResponse(submitContext,request,timeStarted,textMessageSend,topicSubsriber);
  }
 catch (  JMSException jmse) {
    return errorResponse(submitContext,request,timeStarted,jmse);
  }
catch (  Throwable t) {
    SoapUI.logError(t);
  }
 finally {
    if (topicSubsriber != null)     topicSubsriber.close();
    closeSessionAndConnection(jmsConnectionHolder.getTopicConnection(),topicSession);
    closeSessionAndConnection(jmsConnectionHolder.getQueueConnection(),queueSession);
  }
  return null;
}
