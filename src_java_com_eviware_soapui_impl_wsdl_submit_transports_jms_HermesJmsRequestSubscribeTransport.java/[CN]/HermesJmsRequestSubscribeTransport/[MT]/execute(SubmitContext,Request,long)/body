{
  TopicConnectionFactory connectionFactory=null;
  TopicConnection connection=null;
  TopicSession session=null;
  TopicSubscriber topicDurableSubsriber=null;
  try {
    String[] parameters=extractEndpointParameters(request);
    String sessionName=getEndpointParameter(parameters,0,null,submitContext);
    String topicNameSubscribe=getEndpointParameter(parameters,2,Domain.TOPIC,submitContext);
    submitContext.setProperty(HERMES_SESSION_NAME,sessionName);
    Hermes hermes=getHermes(sessionName,request);
    connectionFactory=(TopicConnectionFactory)hermes.getConnectionFactory();
    connection=connectionFactory.createTopicConnection();
    connection.setClientID(sessionName + "-" + topicNameSubscribe);
    connection.start();
    session=connection.createTopicSession(false,Session.AUTO_ACKNOWLEDGE);
    Topic topicSubscribe=(Topic)hermes.getDestination(topicNameSubscribe,Domain.TOPIC);
    topicDurableSubsriber=session.createDurableSubscriber(topicSubscribe,"durableSubscription" + topicNameSubscribe);
    return makeResponse(submitContext,request,timeStarted,null,topicDurableSubsriber);
  }
 catch (  JMSException jmse) {
    return errorResponse(submitContext,request,timeStarted,jmse);
  }
catch (  Throwable t) {
    SoapUI.logError(t);
  }
 finally {
    if (topicDurableSubsriber != null)     topicDurableSubsriber.close();
    closeSessionAndConnection(connection,session);
  }
  return null;
}
