{
  if (request instanceof WsdlRequest || request instanceof HttpTestRequest || request instanceof RestRequest) {
    if (hasAttachment(request)) {
      if (isTextAttachment(request) && !sendAsBytesMessage) {
        return createTextMessageFromAttachment(submitContext,request,session);
      }
 else {
        return createBytesMessage(request,session);
      }
    }
 else {
      submitContext.setProperty(BaseHttpRequestTransport.REQUEST_CONTENT,request.getRequestContent());
      submitContext.setProperty(WSDL_REQUEST,request);
      for (      RequestFilter filter : filters) {
        filter.filterRequest(submitContext,request);
      }
      String requestContent=(String)submitContext.getProperty(BaseHttpRequestTransport.REQUEST_CONTENT);
      if (sendAsBytesMessage) {
        return createBytesMessageFromText(submitContext,requestContent,session);
      }
 else {
        return createTextMessage(submitContext,requestContent,session);
      }
    }
  }
  return null;
}
