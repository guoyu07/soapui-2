{
  try {
    easySSL=new SoapUIEasySSLProtocolSocketFactory();
    initSSL(easySSL);
    Protocol easyhttps=new Protocol("https",(ProtocolSocketFactory)easySSL,443);
    Protocol.registerProtocol("https",easyhttps);
  }
 catch (  Throwable e) {
    SoapUI.log(e);
  }
  Settings settings=SoapUI.getSettings();
  connectionManager=new SoapUIMultiThreadedHttpConnectionManager();
  connectionManager.getParams().setDefaultMaxConnectionsPerHost((int)settings.getLong(HttpSettings.MAX_CONNECTIONS_PER_HOST,500));
  connectionManager.getParams().setMaxTotalConnections((int)settings.getLong(HttpSettings.MAX_TOTAL_CONNECTIONS,2000));
  httpClient=new HttpClient(connectionManager);
  settings.addSettingsListener(new SettingsListener(){
    public void settingChanged(    String name,    String newValue,    String oldValue){
      if (newValue == null)       return;
      if (name.equals(SSLSettings.KEYSTORE) || name.equals(SSLSettings.KEYSTORE_PASSWORD)) {
        try {
          log.info("Updating keyStore..");
          initKeyMaterial(easySSL);
        }
 catch (        Throwable e) {
          SoapUI.logError(e);
        }
      }
 else       if (name.equals(HttpSettings.MAX_CONNECTIONS_PER_HOST)) {
        log.info("Updating max connections per host to " + newValue);
        connectionManager.getParams().setDefaultMaxConnectionsPerHost(Integer.parseInt(newValue));
      }
 else       if (name.equals(HttpSettings.MAX_TOTAL_CONNECTIONS)) {
        log.info("Updating max total connections host to " + newValue);
        connectionManager.getParams().setMaxTotalConnections(Integer.parseInt(newValue));
      }
    }
  }
);
}
