{
  Settings settings=SoapUI.getSettings();
  try {
    trustStore=initTrustStore();
    socketFactory=new SoapUISSLSocketFactory(trustStore);
    SchemeRegistry registry=new SchemeRegistry();
    registry.register(new Scheme("http",80,PlainSocketFactory.getSocketFactory()));
    registry.register(new Scheme("https",443,socketFactory));
    connectionManager=new SoapUIMultiThreadedHttpConnectionManager(registry);
    connectionManager.setMaxConnectionsPerHost((int)settings.getLong(HttpSettings.MAX_CONNECTIONS_PER_HOST,500));
    connectionManager.setMaxTotalConnections((int)settings.getLong(HttpSettings.MAX_TOTAL_CONNECTIONS,2000));
    httpClient=new DefaultHttpClient(connectionManager);
    httpClient.getAuthSchemes().register(AuthPolicy.NTLM,new NTLMSchemeFactory());
    httpClient.getAuthSchemes().register(AuthPolicy.SPNEGO,new NTLMSchemeFactory());
  }
 catch (  Throwable e) {
    SoapUI.log(e);
  }
  settings.addSettingsListener(new SSLSettingsListener());
}
