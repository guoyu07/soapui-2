{
  HostConnectionPool hostPool=getHostPool(hostConfiguration,true);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Allocating new connection, hostConfig=" + hostConfiguration);
  }
  HttpConnectionWithReference connection=new HttpConnectionWithReference(hostConfiguration);
  numConnections++;
  hostPool.numConnections++;
  storeReferenceToConnection(connection,hostConfiguration,this);
  return connection;
}
