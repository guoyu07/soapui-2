{
  socket.getSession().invalidate();
  String protocols=System.getProperty("soapui.https.protocols");
  String ciphers=System.getProperty("soapui.https.ciphers");
  if (StringUtils.hasContent(protocols)) {
    socket.setEnabledProtocols(protocols.split(","));
  }
 else   if (socket.getSupportedProtocols() != null) {
    socket.setEnabledProtocols(socket.getSupportedProtocols());
  }
  if (StringUtils.hasContent(ciphers)) {
    socket.setEnabledCipherSuites(ciphers.split(","));
  }
 else   if (socket.getSupportedCipherSuites() != null) {
    socket.setEnabledCipherSuites(socket.getSupportedCipherSuites());
  }
  return socket;
}
