{
  String invalidateSession=System.getProperty("soapui.https.session.invalidate");
  String protocols=System.getProperty("soapui.https.protocols");
  String ciphers=System.getProperty("soapui.https.ciphers");
  socket.getSession().invalidate();
  if (StringUtils.hasContent(protocols)) {
    socket.setEnabledProtocols(protocols.split(","));
  }
 else   if (socket.getSupportedProtocols() != null) {
    socket.setEnabledProtocols(socket.getSupportedProtocols());
  }
  if (StringUtils.hasContent(ciphers)) {
    socket.setEnabledCipherSuites(ciphers.split(","));
  }
 else   if (socket.getSupportedCipherSuites() != null) {
    socket.setEnabledCipherSuites(filterCipherSuites(socket.getSupportedCipherSuites()));
  }
  return socket;
}
