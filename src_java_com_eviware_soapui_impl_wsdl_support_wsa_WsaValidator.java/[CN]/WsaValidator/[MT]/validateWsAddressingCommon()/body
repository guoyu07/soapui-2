{
  String responseContent=messageExchange.getResponseContent();
  try {
    SoapVersion soapVersion=((WsdlMessageExchange)messageExchange).getOperation().getInterface().getSoapVersion();
    XmlObject xmlObject=XmlObject.Factory.parse(responseContent);
    XmlObject[] envS=xmlObject.selectChildren(soapVersion.getEnvelopeQName());
    Element envelope=(Element)envS[0].getDomNode();
    header=(Element)SoapUtils.getHeaderElement(xmlObject,soapVersion,true).getDomNode();
    if (!header.hasChildNodes()) {
      throw new AssertionException(new AssertionError("WS-A not enabled"));
    }
    String wsaNameSpace=header.getAttribute("xmlns:wsa");
    if (wsaNameSpace == null || wsaNameSpace.isEmpty()) {
      wsaNameSpace=envelope.getAttribute("xmlns:wsa");
      if (wsaNameSpace == null || wsaNameSpace.isEmpty()) {
        throw new AssertionException(new AssertionError("WS-A version is missing."));
      }
    }
    if (wsaNameSpace.equals(WsaUtils.WS_A_VERSION_200508)) {
      wsaVersionNameSpace=WsaUtils.WS_A_VERSION_200508;
    }
 else     if (wsaNameSpace.equals(WsaUtils.WS_A_VERSION_200408)) {
      wsaVersionNameSpace=WsaUtils.WS_A_VERSION_200408;
    }
 else {
      throw new AssertionException(new AssertionError("WS-A version is wrong"));
    }
    NodeList actionList=header.getElementsByTagNameNS(wsaVersionNameSpace,"Action");
    if (actionList.getLength() == 0 || actionList.item(0).getFirstChild() == null) {
      throw new AssertionException(new AssertionError("WS-A Action property is not specified"));
    }
    NodeList destinationList=header.getElementsByTagNameNS(wsaVersionNameSpace,"To");
    if (destinationList.getLength() == 0 || destinationList.item(0).getFirstChild() == null) {
      throw new AssertionException(new AssertionError("WS-A To property is not specified"));
    }
    Element toNode=(Element)destinationList.item(0).getChildNodes();
    NodeList toAddresses=toNode.getElementsByTagNameNS(wsaVersionNameSpace,"Address");
    if (toAddresses.getLength() == 0) {
      throw new AssertionException(new AssertionError("WS-A To Address property is not specified"));
    }
    String toAddressValue=toAddresses.item(0).getFirstChild().getNodeValue();
    if (toAddressValue == null || toAddressValue.isEmpty()) {
      throw new AssertionException(new AssertionError("WS-A To Address property is not specified"));
    }
  }
 catch (  XmlException e) {
    SoapUI.logError(e);
  }
}
