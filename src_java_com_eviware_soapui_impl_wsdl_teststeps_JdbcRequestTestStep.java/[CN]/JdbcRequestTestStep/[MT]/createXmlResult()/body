{
  try {
    DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();
    DocumentBuilder builder=factory.newDocumentBuilder();
    xmlDocumentResult=builder.newDocument();
    Element results=xmlDocumentResult.createElement("Results");
    xmlDocumentResult.appendChild(results);
    resultSet=statement.getResultSet();
    addResultSetXmlPart(results,statement.getResultSet());
    while (statement.getMoreResults()) {
      addResultSetXmlPart(results,statement.getResultSet());
    }
    String oldRes=getXmlStringResult();
    xmlStringResult=getDocumentAsString(xmlDocumentResult);
    setXmlStringResult(xmlStringResult);
    notifyPropertyChanged(RESPONSE_PROPERTY,oldRes,xmlStringResult);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
 finally {
    try {
      if (connection != null)       connection.close();
      if (statement != null)       statement.close();
      if (resultSet != null)       resultSet.close();
    }
 catch (    Exception e) {
    }
  }
}
