{
  ResultSet rs=resultSet;
  Statement stmt=statement;
  try {
    DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();
    DocumentBuilder builder=factory.newDocumentBuilder();
    org.w3c.dom.Document doc=builder.newDocument();
    Element results=doc.createElement("Results");
    doc.appendChild(results);
    ResultSetMetaData rsmd=rs.getMetaData();
    int colCount=rsmd.getColumnCount();
    while (rs.next()) {
      Element row=doc.createElement("Row");
      results.appendChild(row);
      for (int ii=1; ii <= colCount; ii++) {
        String columnName=rsmd.getColumnName(ii);
        String value=rs.getString(ii);
        Element node=doc.createElement(columnName);
        if (!StringUtils.isNullOrEmpty(value)) {
          node.appendChild(doc.createTextNode(value.toString()));
        }
        row.appendChild(node);
      }
    }
    String oldRes=getXmlResult();
    xmlResult=getDocumentAsXml(doc);
    notifyPropertyChanged("xmlResult",oldRes,xmlResult);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
 finally {
    try {
      if (connection != null)       connection.close();
      if (stmt != null)       stmt.close();
      if (rs != null)       rs.close();
    }
 catch (    Exception e) {
    }
  }
}
