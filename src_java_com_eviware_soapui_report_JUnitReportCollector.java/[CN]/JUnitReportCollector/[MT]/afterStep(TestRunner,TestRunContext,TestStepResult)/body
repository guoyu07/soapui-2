{
  TestStep currentStep=runContext.getCurrentStep();
  TestCase testCase=currentStep.getTestCase();
  if (result.getStatus() == TestStepStatus.FAILED) {
    StringBuffer buf=new StringBuffer();
    if (failures.containsKey(testCase)) {
      buf=failures.get(testCase);
    }
 else     failures.put(testCase,buf);
    buf.append("<h3><b>" + result.getTestStep().getName() + " Failed</b></h3>");
    buf.append("<pre>" + XmlUtils.entitize(Arrays.toString(result.getMessages())) + "\n");
    StringWriter stringWriter=new StringWriter();
    PrintWriter writer=new PrintWriter(stringWriter);
    result.writeTo(writer);
    buf.append(XmlUtils.entitize(stringWriter.toString()));
    buf.append("</pre><hr/>");
  }
}
