{
  currentTestCaseRunLogTestStep=testCaseRunLog.addNewTestCaseRunLogTestStep();
  currentTestStepResult=result;
  currentTestCaseRunLogTestStep.setName(currentTestStepResult.getTestStep().getName());
  currentTestCaseRunLogTestStep.setTimeTaken(Long.toString(currentTestStepResult.getTimeTaken()));
  currentTestCaseRunLogTestStep.setStatus(currentTestStepResult.getStatus().toString());
  currentTestCaseRunLogTestStep.setMessageArray(currentTestStepResult.getMessages());
  currentTestCaseRunLogTestStep.setTimestamp(SoapUIMetrics.formatTimestamp(currentTestStepResult.getTimeStamp()));
  ExtendedHttpMethod httpMethod=(ExtendedHttpMethod)runContext.getProperty(BaseHttpRequestTransport.HTTP_METHOD);
  if (httpMethod != null && currentTestStepResult.getTestStep() instanceof HttpRequestTestStep) {
    currentTestCaseRunLogTestStep.setEndpoint(httpMethod.getURI().toString());
    SoapUIMetrics metrics=httpMethod.getMetrics();
    currentTestCaseRunLogTestStep.setTimestamp(metrics.getFormattedTimeStamp());
    currentTestCaseRunLogTestStep.setHttpStatus(String.valueOf(metrics.getHttpStatus()));
    currentTestCaseRunLogTestStep.setContentLength(String.valueOf(metrics.getContentLength()));
    currentTestCaseRunLogTestStep.setReadTime(String.valueOf(metrics.getReadTimer().getDuration()));
    currentTestCaseRunLogTestStep.setTotalTime(String.valueOf(metrics.getTotalTimer().getDuration()));
    currentTestCaseRunLogTestStep.setDnsTime(String.valueOf(metrics.getDNSTimer().getDuration()));
    currentTestCaseRunLogTestStep.setConnectTime(String.valueOf(metrics.getConnectTimer().getDuration()));
    currentTestCaseRunLogTestStep.setTimeToFirstByte(String.valueOf(metrics.getTimeToFirstByteTimer().getDuration()));
    currentTestCaseRunLogTestStep.setHttpMethod(metrics.getHttpMethod());
    currentTestCaseRunLogTestStep.setIpAddress(metrics.getIpAddress());
  }
  Throwable error=result.getError();
  if (error != null) {
    currentTestCaseRunLogTestStep.setErrorMessage(error.getMessage());
  }
}
