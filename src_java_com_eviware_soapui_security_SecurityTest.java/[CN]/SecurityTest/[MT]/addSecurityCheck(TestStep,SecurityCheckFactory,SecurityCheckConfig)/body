{
  SecurityScan newSecCheck=null;
  boolean hasChecks=false;
  List<TestStepSecurityTestConfig> testStepSecurityTestList=getConfig().getTestStepSecurityTestList();
  if (!testStepSecurityTestList.isEmpty()) {
    for (int i=0; i < testStepSecurityTestList.size(); i++) {
      TestStepSecurityTestConfig testStepSecurityTest=testStepSecurityTestList.get(i);
      if (testStepSecurityTest.getTestStepId().equals(testStep.getId())) {
        newSecCheck=buildSecurityCheck(factory,newCheckConfig,testStepSecurityTest,testStep);
        hasChecks=true;
        break;
      }
    }
  }
  if (!hasChecks) {
    TestStepSecurityTestConfig testStepSecurityTest=getConfig().addNewTestStepSecurityTest();
    testStepSecurityTest.setTestStepId(testStep.getId());
    newSecCheck=buildSecurityCheck(factory,newCheckConfig,testStepSecurityTest,testStep);
  }
  addSecurityCheckToMapByTestStepId(testStep.getId(),newSecCheck);
  return newSecCheck;
}
