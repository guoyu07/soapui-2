{
  if (getConfig() != null) {
    if (!getConfig().getTestStepSecurityTestList().isEmpty()) {
      for (      TestStepSecurityTestConfig testStepSecurityTestListConfig : getConfig().getTestStepSecurityTestList()) {
        List<AbstractSecurityCheck> checkList=new ArrayList<AbstractSecurityCheck>();
        if (testStepSecurityTestListConfig != null) {
          if (!testStepSecurityTestListConfig.getTestStepSecurityCheckList().isEmpty()) {
            for (            SecurityCheckConfig secCheckConfig : testStepSecurityTestListConfig.getTestStepSecurityCheckList()) {
              TestStep testStep=null;
              for (              TestStep ts : testCase.getTestSteps().values())               if (testStepSecurityTestListConfig.getTestStepId().equals(ts.getId())) {
                testStep=ts;
                AbstractSecurityCheck securityCheck=SoapUI.getSoapUICore().getSecurityCheckRegistry().getFactory(secCheckConfig.getType()).buildSecurityCheck(testStep,secCheckConfig,this);
                checkList.add(securityCheck);
              }
            }
          }
        }
        if (!checkList.isEmpty()) {
          securityChecksMap.put(testStepSecurityTestListConfig.getTestStepId(),checkList);
        }
      }
    }
  }
  return securityChecksMap;
}
