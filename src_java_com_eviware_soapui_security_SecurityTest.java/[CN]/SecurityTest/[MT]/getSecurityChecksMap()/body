{
  HashMap<String,List<AbstractSecurityCheck>> securityChecksMap=new HashMap<String,List<AbstractSecurityCheck>>();
  if (getConfig() != null) {
    if (!getConfig().getTestStepSecurityTestList().isEmpty()) {
      for (      TestStepSecurityTestConfig testStepSecurityTestListConfig : getConfig().getTestStepSecurityTestList()) {
        List<AbstractSecurityCheck> checkList=new ArrayList<AbstractSecurityCheck>();
        if (testStepSecurityTestListConfig != null) {
          if (!testStepSecurityTestListConfig.getTestStepSecurityCheckList().isEmpty()) {
            for (            SecurityCheckConfig secCheckConfig : testStepSecurityTestListConfig.getTestStepSecurityCheckList()) {
              AbstractSecurityCheck securityCheck=SecurityCheckRegistry.getInstance().getFactory(secCheckConfig.getType()).buildSecurityCheck(secCheckConfig,this);
              checkList.add(securityCheck);
            }
          }
        }
        securityChecksMap.put(testStepSecurityTestListConfig.getTestStepId(),checkList);
      }
    }
  }
  return securityChecksMap;
}
