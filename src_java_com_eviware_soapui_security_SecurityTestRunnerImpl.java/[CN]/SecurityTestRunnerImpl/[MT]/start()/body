{
  securityTest.getTestCase().beforeSave();
  hasTornDown=false;
  context=new SecurityTestContext(this);
  try {
    securityTest.runStartupScript(context,this);
  }
 catch (  Exception e1) {
    SoapUI.logError(e1);
  }
  status=Status.RUNNING;
  if (status == Status.RUNNING) {
    WsdlTestCase testCase=securityTest.getTestCase();
    List<TestStep> testStepsList=testCase.getTestStepList();
    HashMap<String,List<SecurityCheck>> secCheckMap=securityTest.getSecurityChecksMap();
    WsdlTestCaseRunner testCaseRunner=new WsdlTestCaseRunner(testCase,new StringToObjectMap());
    for (    TestStep testStep : testStepsList) {
      if (secCheckMap.containsKey(testStep.getName())) {
        List<SecurityCheck> testStepChecksList=secCheckMap.get(testStep.getName());
        for (        SecurityCheck securityCheck : testStepChecksList) {
          if (securityCheck.acceptsTestStep(testStep))           securityCheck.run(cloneForSecurityCheck((WsdlTestStep)testStep),context,securityTest.getSecurityTestLog());
        }
      }
 else {
        testCaseRunner.runTestStepByName(testStep.getName());
      }
    }
    testCase.release();
  }
  stop();
}
