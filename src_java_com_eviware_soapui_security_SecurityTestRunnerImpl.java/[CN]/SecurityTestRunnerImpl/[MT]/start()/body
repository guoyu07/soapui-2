{
  securityTest.getTestCase().beforeSave();
  listeners=securityTest.getTestRunListeners();
  hasTornDown=false;
  context=new WsdlTestRunContext(this,new StringToObjectMap());
  try {
    securityTest.runStartupScript(context,this);
  }
 catch (  Exception e1) {
    SoapUI.logError(e1);
  }
  status=Status.RUNNING;
  if (status == Status.RUNNING) {
    WsdlTestCase testCase=securityTest.getTestCase();
    List<TestStep> testStepsList=testCase.getTestStepList();
    HashMap<String,List<SecurityCheck>> secCheckMap=securityTest.getSecurityChecksMap();
    SecurityTestRunnerImpl testCaseRunner=new SecurityTestRunnerImpl(securityTest);
    for (    TestStep testStep : testStepsList) {
      if (!testStep.isDisabled()) {
        if (secCheckMap.containsKey(testStep.getId())) {
          List<SecurityCheck> testStepChecksList=secCheckMap.get(testStep.getId());
          for (          SecurityCheck securityCheck : testStepChecksList) {
            if (securityCheck.acceptsTestStep(testStep))             securityCheck.run(cloneForSecurityCheck((WsdlTestStep)testStep),context,securityTest.getSecurityTestLog());
          }
        }
 else {
          testCaseRunner.runTestStepByName(testStep.getName());
        }
      }
    }
    status=Status.FINISHED;
    notifyAfterRun();
  }
  stop();
}
