{
  List<ModelItem> items=new ArrayList<ModelItem>();
  String targetTestSuiteName=dialog.getValue(CloneParameterDialog.TARGET_TESTSUITE);
  String targetTestCaseName=dialog.getValue(CloneParameterDialog.TARGET_TESTCASE);
  String targetSecurityTestName=dialog.getValue(CloneParameterDialog.TARGET_SECURITYTEST);
  String targetSecurityTestStepName=dialog.getValue(CloneParameterDialog.TARGET_TESTSTEP);
  String[] targetSecurityChecks=StringUtils.toStringArray(((XFormMultiSelectList)dialog.getFormField(CloneParameterDialog.TARGET_SECURITYCHECK)).getSelectedOptions());
  if (targetSecurityChecks.length == 0) {
    if (showErrorMessage) {
      UISupport.showErrorMessage("No SecurityChecks selected..");
    }
    return items;
  }
  int[] indexes=((XFormOptionsField)dialog.getFormField(CloneParameterDialog.PARAMETERS)).getSelectedIndexes();
  if (indexes.length == 0) {
    if (showErrorMessage) {
      UISupport.showErrorMessage("No Parameters selected..");
    }
    return items;
  }
  Project project=securityCheck.getTestStep().getTestCase().getTestSuite().getProject();
  TestSuite targetTestSuite=project.getTestSuiteByName(targetTestSuiteName);
  TestCase targetTestCase=targetTestSuite.getTestCaseByName(targetTestCaseName);
  SecurityTest targetSecurityTest=targetTestCase.getSecurityTestByName(targetSecurityTestName);
  TestStep targetTestStep=targetTestCase.getTestStepByName(targetSecurityTestStepName);
  boolean overwrite=dialog.getBooleanValue(CloneParameterDialog.OVERWRITE);
  for (  String checkName : targetSecurityChecks) {
    AbstractSecurityCheckWithProperties targetSecurityCheck=(AbstractSecurityCheckWithProperties)targetSecurityTest.getTestStepSecurityCheckByName(targetTestStep.getId(),checkName);
    for (    int i : indexes) {
      SecurityCheckedParameter checkParameter=securityCheck.getParameterAt(i);
      String newParameterLabel=checkParameter.getLabel();
      if (securityCheck.getParameterByLabel(checkParameter.getLabel()) != null) {
        if (securityCheck.equals(targetSecurityCheck)) {
          newParameterLabel="Copy of " + checkParameter.getLabel();
        }
      }
      if (targetSecurityCheck.importParameter(checkParameter,overwrite,newParameterLabel) && !items.contains(targetSecurityCheck)) {
        items.add(targetSecurityCheck);
      }
    }
  }
  return items;
}
