{
  securityCheckResult=new SecurityCheckResult(this);
  SecurityTestRunListener[] securityTestListeners=((SecurityTest)getParent()).getSecurityTestRunListeners();
  PropertyChangeNotifier notifier=new PropertyChangeNotifier();
  boolean noMutations=true;
  while (hasNext(testStep,context)) {
    noMutations=false;
    if (((SecurityTestRunnerImpl)securityTestRunner).isCanceled()) {
      securityCheckResult.setStatus(ResultStatus.CANCELED);
      clear();
      return securityCheckResult;
    }
    securityCheckRequestResult=new SecurityCheckRequestResult(this);
    securityCheckRequestResult.startTimer();
    originalTestStepClone=((SecurityTestRunnerImpl)securityTestRunner).cloneForSecurityCheck((WsdlTestStep)this.testStep);
    execute(securityTestRunner,originalTestStepClone,context);
    notifier.notifyChange();
    securityCheckRequestResult.stopTimer();
    assertResponse(getSecurityCheckRequestResult().getMessageExchange(),context);
    securityCheckResult.addSecurityRequestResult(getSecurityCheckRequestResult());
    for (int i=0; i < securityTestListeners.length; i++) {
      securityTestListeners[i].afterSecurityCheckRequest((SecurityTestRunnerImpl)securityTestRunner,context,securityCheckRequestResult);
    }
    try {
      Thread.sleep(getExecutionStrategy().getDelay());
    }
 catch (    InterruptedException e) {
      SoapUI.logError(e,"Security Scan Request Delay Interrupted!");
    }
  }
  if (noMutations) {
    securityCheckResult.setStatus(ResultStatus.NOTHING_TO_SEND);
  }
  return securityCheckResult;
}
