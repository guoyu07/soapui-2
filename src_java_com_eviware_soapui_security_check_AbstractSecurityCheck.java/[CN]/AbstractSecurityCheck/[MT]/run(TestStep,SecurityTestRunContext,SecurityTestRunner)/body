{
  securityCheckResult=new SecurityCheckResult(this);
  securityTestListeners=((SecurityTest)getParent()).getSecurityTestRunListeners();
  try {
    runSetupScript(securityTestRunner,context);
  }
 catch (  Exception e) {
    SoapUI.log.error("Exception during Test Execution",e);
    securityCheckResult.setStatus(SecurityStatus.FAILED);
  }
  PropertyChangeNotifier notifier=new PropertyChangeNotifier();
  while (hasNext(testStep,context)) {
    if (((SecurityTestRunnerImpl)securityTestRunner).isCanceled()) {
      securityCheckResult.setStatus(SecurityStatus.CANCELED);
      clear();
      return securityCheckResult;
    }
    securityCheckRequestResult=new SecurityCheckRequestResult(this);
    securityCheckRequestResult.startTimer();
    originalTestStepClone=((SecurityTestRunnerImpl)securityTestRunner).cloneForSecurityCheck((WsdlTestStep)this.testStep);
    execute(securityTestRunner,originalTestStepClone,context);
    notifier.notifyChange();
    securityCheckRequestResult.stopTimer();
    assertResponse(getSecurityCheckRequestResult().getMessageExchange(),context);
    securityCheckResult.addSecurityRequestResult(getSecurityCheckRequestResult());
    for (int i=0; i < securityTestListeners.length; i++) {
      securityTestListeners[i].afterSecurityCheckRequest((SecurityTestRunnerImpl)securityTestRunner,context,securityCheckRequestResult);
    }
    try {
      Thread.sleep(getExecutionStrategy().getDelay());
    }
 catch (    InterruptedException e) {
      SoapUI.logError(e,"Security Check Request Delay Interrupted!");
    }
  }
  try {
    runTearDownScript(securityTestRunner,context);
  }
 catch (  Exception e) {
    SoapUI.log.error("Exception during Test Execution",e);
    securityCheckResult.setStatus(SecurityStatus.FAILED);
  }
  return securityCheckResult;
}
