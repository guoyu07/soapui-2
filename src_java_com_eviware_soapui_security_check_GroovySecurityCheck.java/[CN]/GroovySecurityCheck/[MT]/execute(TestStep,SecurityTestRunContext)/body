{
  getScriptEngine().setScript(groovyscc.getExecuteScript().getStringValue());
  getScriptEngine().setVariable("request",getTestStep().getProperty("Request").getValue());
  getScriptEngine().setVariable("log",SoapUI.ensureGroovyLog());
  try {
    scriptResult=getScriptEngine().run();
  }
 catch (  Exception e) {
    SoapUI.logError(e);
  }
 finally {
    if (scriptResult != null) {
      getTestStep().getProperty("Request").setValue((String)scriptResult);
      SecurityTestRunnerImpl securityTestRunner=new SecurityTestRunnerImpl((SecurityTest)getParent(),new StringToObjectMap());
      getTestStep().run(securityTestRunner,securityTestRunner.getRunContext());
    }
    getScriptEngine().clearVariables();
  }
}
