{
  for (  MaliciousAttachmentConfig element : list) {
    File file=new File(element.getFilename());
    if (element.getEnabled()) {
      try {
        if (!file.exists()) {
          if (generated) {
            file=new RandomFile(element.getSize(),"attachment",element.getContentType()).next();
          }
 else {
            UISupport.showErrorMessage("Missing file: " + file.getName());
            return;
          }
        }
        addAttachment(testStep,file,element.getContentType(),generated);
      }
 catch (      IOException e) {
        UISupport.showErrorMessage(e);
      }
    }
  }
}
