{
  if (acceptsTestStep(testStep)) {
    WsdlTestCaseRunner testCaseRunner=new WsdlTestCaseRunner((WsdlTestCase)testStep.getTestCase(),new StringToObjectMap());
    String originalResponse=getOriginalResult(testCaseRunner,testStep).getResponse().getContentAsXml();
    if (getExecutionStrategy().equals(SecurityCheckParameterSelector.SEPARATE_REQUEST_STRATEGY)) {
      for (      String param : getParamsToCheck()) {
        Fuzzer sqlFuzzer=Fuzzer.getSQLFuzzer();
        while (sqlFuzzer.hasNext()) {
          sqlFuzzer.getNextFuzzedTestStep(testStep,param);
          testStep.run(testCaseRunner,testCaseRunner.getRunContext());
          AbstractHttpRequest<?> lastRequest=getRequest(testStep);
          if (StringUtils.getLevenshteinDistance(originalResponse,lastRequest.getResponse().getContentAsString()) > MINIMUM_STRING_DISTANCE) {
            securityTestLog.addEntry(new SecurityTestLogMessageEntry("Possible SQL Injection Vulnerability Detected",null));
            setStatus(Status.FAILED);
          }
          analyze(testStep,context,securityTestLog);
        }
      }
    }
 else {
      Fuzzer sqlFuzzer=Fuzzer.getSQLFuzzer();
      while (sqlFuzzer.hasNext()) {
        sqlFuzzer.getNextFuzzedTestStep(testStep,getParamsToCheck());
        testStep.run(testCaseRunner,testCaseRunner.getRunContext());
        HttpTestRequestInterface<?> lastRequest=((HttpTestRequestStepInterface)testStep).getTestRequest();
        if (StringUtils.getLevenshteinDistance(originalResponse,((AbstractHttpRequest<?>)lastRequest).getResponse().getContentAsString()) > MINIMUM_STRING_DISTANCE) {
          securityTestLog.addEntry(new SecurityTestLogMessageEntry("Possible SQL Injection Vulnerability Detected",new HttpResponseMessageExchange(lastRequest)));
          setStatus(Status.FAILED);
        }
        analyze(testStep,context,securityTestLog);
      }
    }
  }
}
