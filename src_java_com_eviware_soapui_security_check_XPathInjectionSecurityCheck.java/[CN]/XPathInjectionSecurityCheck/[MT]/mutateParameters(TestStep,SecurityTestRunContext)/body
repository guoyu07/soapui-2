{
  mutation=true;
  for (  SecurityCheckedParameter parameter : getParameterHolder().getParameterList()) {
    if (parameter.isChecked()) {
      TestProperty property=testStep.getProperties().get(parameter.getName());
      if (parameter.getXPath() == null || parameter.getXPath().trim().length() == 0) {
        for (        String xpathInjectionString : xpathList.getXpathListList()) {
          if (!parameterMutations.containsKey(parameter))           parameterMutations.put(parameter,new ArrayList<String>());
          parameterMutations.get(parameter).add(xpathInjectionString);
        }
      }
 else {
        if (property.getValue() == null && property.getDefaultValue() == null)         continue;
        String value=property.getValue();
        try {
          XmlObjectTreeModel model=null;
          if (testStep instanceof WsdlTestRequestStep)           model=new XmlObjectTreeModel(((WsdlTestRequestStep)testStep).getOperation().getInterface().getDefinitionContext().getSchemaTypeSystem(),XmlObject.Factory.parse(value));
          if (testStep instanceof RestTestRequestStep || testStep instanceof HttpTestRequestStep)           model=new XmlObjectTreeModel(XmlObject.Factory.parse(value));
          XmlTreeNode[] nodes=model.selectTreeNodes(context.expand(parameter.getXPath()));
          for (          String xpathInjectionString : xpathList.getXpathListList()) {
            if (nodes.length > 0) {
              if (!parameterMutations.containsKey(parameter))               parameterMutations.put(parameter,new ArrayList<String>());
              parameterMutations.get(parameter).add(xpathInjectionString);
            }
          }
        }
 catch (        Exception e1) {
          SoapUI.logError(e1,"[XPathInjection]Failed to select XPath for source property value [" + value + "]");
        }
      }
    }
  }
}
