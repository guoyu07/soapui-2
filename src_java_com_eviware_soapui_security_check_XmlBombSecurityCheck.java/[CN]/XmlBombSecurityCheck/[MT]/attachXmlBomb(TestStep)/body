{
  Attachment attach=null;
  if (isAttachXmlBomb()) {
    AbstractHttpRequest<?> request=(AbstractHttpRequest<?>)getRequest(testStep);
    if (currentIndex < getBombList().size()) {
      String bomb=getBombList().get(currentIndex);
      try {
        File bombFile=File.createTempFile(getAttachmentPrefix(),".xml");
        BufferedWriter writer=new BufferedWriter(new FileWriter(bombFile));
        writer.write(bomb);
        writer.write("<payload>&payload;</payload>");
        writer.flush();
        attach=request.attachFile(bombFile,false);
        bombFile.delete();
        currentIndex++;
      }
 catch (      IOException e) {
        SoapUI.logError(e);
      }
    }
 else     if (currentIndex == getBombList().size()) {
      try {
        File bombFile=File.createTempFile(getAttachmentPrefix(),".xml");
        BufferedWriter writer=new BufferedWriter(new FileWriter(bombFile));
        writer.write(createQuadraticExpansionAttack(null,null));
        writer.flush();
        attach=request.attachFile(bombFile,false);
        bombFile.delete();
      }
 catch (      IOException e) {
        SoapUI.logError(e);
      }
      currentIndex++;
    }
  }
  return attach;
}
