{
  currentIndex=0;
  SecurityTestRunnerImpl securityTestRunner=new SecurityTestRunnerImpl((SecurityTest)getParent(),new StringToObjectMap());
  String originalResponse=getOriginalResult(securityTestRunner,testStep).getResponse().getContentAsXml();
  String originalRequest=getRequest(testStep).getRequestContent();
  if (isAttachXmlBomb()) {
    while (currentIndex < getBombList().size() + 1) {
      Attachment attach=attachXmlBomb(testStep);
      ((AbstractHttpRequest<?>)getRequest(testStep)).removeAttachment(attach);
      ((AbstractHttpRequest<?>)getRequest(testStep)).setRequestContent(originalRequest);
    }
    currentIndex=0;
  }
  if (getExecutionStrategy().equals(AbstractSecurityCheck.SEPARATE_REQUEST_STRATEGY) && getParameters().getParameterList().size() > 0) {
    for (    SecurityCheckedParameter param : getParameters().getParameterList()) {
      if (param != null) {
        while (currentIndex < getBombList().size() + 1) {
          generateNextRequest(testStep,param.getName());
          ((AbstractHttpRequest<?>)getRequest(testStep)).setRequestContent(originalRequest);
        }
      }
    }
  }
 else   if (getParameters().getParameterList().size() > 0) {
    while (currentIndex < getBombList().size() + 1) {
      generateNextRequest(testStep,getParameters().getParameterList());
      ((AbstractHttpRequest<?>)getRequest(testStep)).setRequestContent(originalRequest);
    }
  }
}
