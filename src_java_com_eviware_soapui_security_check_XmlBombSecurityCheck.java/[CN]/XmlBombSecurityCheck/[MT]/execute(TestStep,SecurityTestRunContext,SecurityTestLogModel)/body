{
  currentIndex=0;
  WsdlTestCaseRunner testCaseRunner=new WsdlTestCaseRunner((WsdlTestCase)testStep.getTestCase(),new StringToObjectMap());
  String originalResponse=getOriginalResult(testCaseRunner,testStep).getResponse().getContentAsXml();
  for (  String param : getParamsToCheck()) {
    while (currentIndex < getBombList().size()) {
      generateNextRequest(testStep,param);
      testStep.run(testCaseRunner,testCaseRunner.getRunContext());
      AbstractHttpRequest<?> lastRequest=getRequest(testStep);
      if (StringUtils.getLevenshteinDistance(originalResponse,lastRequest.getResponse().getContentAsString()) > MINIMUM_STRING_DISTANCE) {
        securityTestLog.addEntry(new SecurityTestLogMessageEntry("Possible XML Bomb Vulnerability Detected",null));
        setStatus(Status.FAILED);
      }
      analyze(testStep,context,securityTestLog);
    }
  }
}
