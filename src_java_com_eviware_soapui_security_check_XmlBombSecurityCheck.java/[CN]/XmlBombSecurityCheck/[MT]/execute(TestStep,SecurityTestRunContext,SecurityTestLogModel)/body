{
  currentIndex=0;
  WsdlTestCaseRunner testCaseRunner=new WsdlTestCaseRunner((WsdlTestCase)testStep.getTestCase(),new StringToObjectMap());
  String originalResponse=getOriginalResult(testCaseRunner,testStep).getResponse().getContentAsXml();
  if (isAttachXmlBomb()) {
    while (currentIndex < getBombList().size()) {
      attachXmlBomb(testStep);
      runCheck(testStep,context,securityTestLog,testCaseRunner,originalResponse);
    }
    currentIndex=0;
  }
  if (getExecutionStrategy().equals(SecurityCheckParameterSelector.SEPARATE_REQUEST_STRATEGY)) {
    for (    String param : getParamsToCheck()) {
      while (currentIndex < getBombList().size()) {
        generateNextRequest(testStep,param);
        runCheck(testStep,context,securityTestLog,testCaseRunner,originalResponse);
      }
    }
  }
 else {
    while (currentIndex < getBombList().size()) {
      generateNextRequest(testStep,getParamsToCheck());
      runCheck(testStep,context,securityTestLog,testCaseRunner,originalResponse);
    }
  }
}
