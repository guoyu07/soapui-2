{
  currentIndex=0;
  WsdlTestCaseRunner testCaseRunner=new WsdlTestCaseRunner((WsdlTestCase)testStep.getTestCase(),new StringToObjectMap());
  String originalResponse=getOriginalResult(testCaseRunner,testStep).getResponse().getContentAsXml();
  String originalRequest=getRequest(testStep).getRequestContent();
  if (isAttachXmlBomb()) {
    while (currentIndex < getBombList().size() + 1) {
      Attachment attach=attachXmlBomb(testStep);
      runCheck(testStep,context,securityTestLog,testCaseRunner,originalResponse,"Possible XML Bomb Vulnerability Detected");
      getRequest(testStep).removeAttachment(attach);
      getRequest(testStep).setRequestContent(originalRequest);
    }
    currentIndex=0;
  }
  if (getExecutionStrategy().equals(SecurityCheckParameterSelector.SEPARATE_REQUEST_STRATEGY) && getParamsToCheck().size() > 0) {
    for (    String param : getParamsToCheck()) {
      if (param != null) {
        while (currentIndex < getBombList().size() + 1) {
          generateNextRequest(testStep,param);
          runCheck(testStep,context,securityTestLog,testCaseRunner,originalResponse,"Possible XML Bomb Vulnerability Detected");
          getRequest(testStep).setRequestContent(originalRequest);
        }
      }
    }
  }
 else   if (getParamsToCheck().size() > 0) {
    while (currentIndex < getBombList().size() + 1) {
      generateNextRequest(testStep,getParamsToCheck());
      runCheck(testStep,context,securityTestLog,testCaseRunner,originalResponse,"Possible XML Bomb Vulnerability Detected");
      getRequest(testStep).setRequestContent(originalRequest);
    }
  }
  return null;
}
