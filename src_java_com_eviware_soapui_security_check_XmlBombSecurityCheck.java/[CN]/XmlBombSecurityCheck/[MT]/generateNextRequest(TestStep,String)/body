{
  AbstractHttpRequest<?> request=getRequest(testStep);
  if (currentIndex < getBombList().size()) {
    String bomb=getBombList().get(currentIndex);
    if (isAttachXmlBomb()) {
      try {
        File bombFile=File.createTempFile(getAttachmentPrefix(),".xml");
        BufferedWriter writer=new BufferedWriter(new FileWriter(bombFile));
        writer.write(bomb);
        writer.write("<payload>&payload</payload>");
        writer.flush();
        request.attachFile(bombFile,false);
        bombFile.delete();
      }
 catch (      IOException e) {
        SoapUI.logError(e);
      }
    }
 else {
      String requestContent=request.getRequestContent();
      String newRequestContent=requestContent;
      if (testStep instanceof WsdlTestRequestStep) {
        newRequestContent=XmlUtils.setXPathContent(request.getRequestContent(),param.substring(param.lastIndexOf("\n") + 1),"&&payload&&");
        newRequestContent=newRequestContent.replaceAll("&amp;&amp;payload&amp;&amp;","&payload");
      }
      newRequestContent=bomb + newRequestContent;
      request.setRequestContent(newRequestContent);
    }
    currentIndex++;
  }
 else {
    return null;
  }
  return testStep;
}
