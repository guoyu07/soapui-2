{
  mutation=true;
  ArrayList<DTDTypeConfig> allDTDs=new ArrayList<DTDTypeConfig>();
  if (xmlBombConfig.getUseExternalDTD())   allDTDs.addAll(xmlBombConfig.getExternalDTDList());
  if (xmlBombConfig.getUseInternalDTD())   allDTDs.addAll(xmlBombConfig.getInternalDTDList());
  for (  SecurityCheckedParameter parameter : getParameterHolder().getParameterList()) {
    if (parameter.isChecked()) {
      TestProperty property=testStep.getProperties().get(parameter.getName());
      if (parameter.getXpath() == null || parameter.getXpath().trim().length() == 0) {
        for (        DTDTypeConfig dtd : allDTDs) {
          if (!parameterMutations.containsKey(parameter))           parameterMutations.put(parameter,new ArrayList<DTDTypeConfig>());
          parameterMutations.get(parameter).add(dtd);
        }
      }
 else {
        if (property.getValue() == null && property.getDefaultValue() == null)         continue;
        String value=context.expand(property.getValue());
        XmlObjectTreeModel model=null;
        model=new XmlObjectTreeModel(property.getSchemaType().getTypeSystem(),XmlObject.Factory.parse(value));
        XmlTreeNode[] nodes=model.selectTreeNodes(context.expand(parameter.getXpath()));
        for (        DTDTypeConfig dtd : allDTDs) {
          if (nodes.length > 0) {
            if (!parameterMutations.containsKey(parameter))             parameterMutations.put(parameter,new ArrayList<DTDTypeConfig>());
            parameterMutations.get(parameter).add(dtd);
          }
        }
      }
    }
  }
}
