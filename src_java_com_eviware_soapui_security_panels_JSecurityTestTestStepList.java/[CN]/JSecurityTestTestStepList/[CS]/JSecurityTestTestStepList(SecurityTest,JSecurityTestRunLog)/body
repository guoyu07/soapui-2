{
  this.securityTest=securityTest;
  setLayout(new BorderLayout());
  JXToolBar toolbar=initToolbar();
  securityCheckPopUp=new JPopupMenu();
  securityCheckPopUp.add(addSecurityCheckAction);
  securityCheckPopUp.add(configureSecurityCheckAction);
  securityCheckPopUp.addSeparator();
  securityCheckPopUp.add(removeSecurityCheckAction);
  securityCheckPopUp.add(new ShowOnlineHelpAction(HelpUrls.RESPONSE_ASSERTIONS_HELP_URL));
  securityCheckWithPropertiesPopUp=new JPopupMenu();
  securityCheckWithPropertiesPopUp.add(addSecurityCheckAction);
  securityCheckWithPropertiesPopUp.add(configureSecurityCheckAction);
  securityCheckWithPropertiesPopUp.add(cloneParametersAction);
  securityCheckWithPropertiesPopUp.addSeparator();
  securityCheckWithPropertiesPopUp.add(removeSecurityCheckAction);
  securityCheckWithPropertiesPopUp.add(new ShowOnlineHelpAction(HelpUrls.RESPONSE_ASSERTIONS_HELP_URL));
  testStepPopUp=new JPopupMenu();
  initTestStepPopUpActions();
  testStepPopUp.addSeparator();
  testStepPopUp.add(new ShowOnlineHelpAction(HelpUrls.RESPONSE_ASSERTIONS_HELP_URL));
  treeModel=new SecurityCheckTree(securityTest,new SecurityTreeRootNode(securityTest));
  securityTestTree=new JXTree(treeModel);
  securityTestTree.putClientProperty("JTree.lineStyle","None");
  securityTestTree.setUI(new CustomTreeUI());
  securityTestTree.setRootVisible(false);
  securityTestTree.setLargeModel(true);
  cellRender=new SecurityTreeCellRender();
  securityTestTree.setCellRenderer(cellRender);
  securityTestTree.getSelectionModel().setSelectionMode(TreeSelectionModel.SINGLE_TREE_SELECTION);
  securityTestTree.addTreeSelectionListener(this);
  securityTestTree.addMouseListener(this);
  securityTestTree.setRowHeight(30);
  securityTestTree.setToggleClickCount(0);
  securityTestTree.setBackground(new Color(240,240,240));
  securityTestTree.setScrollsOnExpand(true);
  add(toolbar,BorderLayout.NORTH);
  scrollPane=new JScrollPane(securityTestTree);
  scrollPane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
  add(scrollPane,BorderLayout.CENTER);
  securityTest.getTestCase().getTestSuite().addTestSuiteListener(testSuiteListener);
  securityTest.addSecurityTestListener(this);
  testRunListener=new InternalSecurityTestRunListener();
  securityTest.addSecurityTestRunListener(testRunListener);
  for (int row=0; row < securityTestTree.getRowCount(); row++) {
    securityTestTree.expandRow(row);
  }
  this.securityTestLog=securityTestLog;
}
