{
  DefaultMutableTreeNode node=(DefaultMutableTreeNode)securityTestTree.getLastSelectedPathComponent();
  if (node == null)   return;
  if ((e.getModifiers() & InputEvent.BUTTON3_MASK) == InputEvent.BUTTON3_MASK)   return;
  if (e.getClickCount() == 1) {
    if (securityTestTree.isExpanded(TreePathUtils.getPath(node))) {
      securityTestTree.collapseRow(securityTestTree.getRowForLocation(e.getX(),e.getY()));
    }
 else {
      securityTestTree.expandRow(securityTestTree.getRowForLocation(e.getX(),e.getY()));
    }
    e.consume();
    return;
  }
  if (node instanceof SecurityCheckNode) {
    SecurityCheck securityCheck=((SecurityCheckNode)securityTestTree.getLastSelectedPathComponent()).getSecurityCheck();
    if (securityCheck.isConfigurable()) {
      XFormDialog dialog=SoapUI.getSoapUICore().getSecurityCheckRegistry().getUIBuilder().buildSecurityCheckConfigurationDialog((AbstractSecurityCheck)securityCheck);
      dialog.show();
    }
  }
 else {
    if (securityTestTree.isExpanded(TreePathUtils.getPath(node))) {
      UISupport.selectAndShow(((TestStepNode)node).getTestStep());
      e.consume();
    }
  }
}
