{
  DefaultMutableTreeNode node=(DefaultMutableTreeNode)securityTestTree.getLastSelectedPathComponent();
  if (node == null)   return;
  if (node instanceof TestStepNode) {
    if (!node.getAllowsChildren())     return;
    addSecurityCheckAction.setEnabled(true);
    configureSecurityCheckAction.setEnabled(false);
    removeSecurityCheckAction.setEnabled(false);
    cloneParametersAction.setEnabled(false);
  }
 else   if (node instanceof SecurityCheckNode) {
    securityTestLog.locateSecurityCheck(((SecurityCheckNode)securityTestTree.getLastSelectedPathComponent()).getSecurityCheck());
    addSecurityCheckAction.setEnabled(false);
    configureSecurityCheckAction.setEnabled(true);
    removeSecurityCheckAction.setEnabled(true);
    if (((SecurityCheckNode)securityTestTree.getLastSelectedPathComponent()).getSecurityCheck() instanceof AbstractSecurityCheckWithProperties) {
      cloneParametersAction.setEnabled(true);
      cloneParametersAction.setSecurityCheck((AbstractSecurityCheckWithProperties)((SecurityCheckNode)securityTestTree.getLastSelectedPathComponent()).getSecurityCheck());
    }
  }
}
