{
  String[] availableChecksNames=SecurityCheckRegistry.getInstance().getAvailableSecurityChecksNames(testStep);
  String type=UISupport.prompt("Specify type of security check","Add SecurityCheck",availableChecksNames);
  if (type == null || type.trim().length() == 0)   return;
  String name=UISupport.prompt("Specify name for security check","Add SecurityCheck",securityTest.findTestStepCheckUniqueName(testStep.getId(),type));
  if (name == null || name.trim().length() == 0)   return;
  while (securityTest.getTestStepSecurityCheckByName(testStep.getId(),name) != null) {
    name=UISupport.prompt("Specify unique name for check","Add SecurityCheck",name + " " + (securityTest.getTestStepSecurityChecks(testStep.getId()).size()));
    if (name == null) {
      return;
    }
  }
  if (availableChecksNames == null || availableChecksNames.length == 0) {
    UISupport.showErrorMessage("No security checks available for this message");
    return;
  }
  SecurityCheck securityCheck=securityTest.addSecurityCheck(testStep,type,name);
  if (securityCheck == null) {
    UISupport.showErrorMessage("Failed to add security check");
    return;
  }
  securityCheckList.setSelectedIndex(securityCheckListModel.getSize() - 1);
  AbstractSecurityCheck secCheck=getCurrentSecurityCheck();
  XFormDialog dialog=SoapUI.getSoapUICore().getSecurityCheckRegistry().getUIBuilder().buildSecurityCheckConfigurationDialog(secCheck);
  dialog.show();
}
