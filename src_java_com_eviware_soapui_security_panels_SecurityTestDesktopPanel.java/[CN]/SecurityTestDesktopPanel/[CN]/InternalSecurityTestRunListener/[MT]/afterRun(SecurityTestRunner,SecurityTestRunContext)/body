{
  if (SoapUI.getTestMonitor().hasRunningSecurityTest(getModelItem().getTestCase()))   return;
  SecurityTestRunnerImpl securityRunner=(SecurityTestRunnerImpl)testRunner;
  if (testRunner.getStatus() == SecurityTestRunner.Status.CANCELED)   securityTestLog.addText("SecurityTest canceled [" + testRunner.getReason() + "], time taken = "+ securityRunner.getTimeTaken());
 else   if (testRunner.getStatus() == SecurityTestRunner.Status.FAILED) {
    String msg=securityRunner.getReason();
    if (securityRunner.getError() != null) {
      if (msg != null)       msg+=":";
      msg+=securityRunner.getError();
    }
    securityTestLog.addText("SecurityTest failed [" + msg + "], time taken = "+ securityRunner.getTimeTaken());
  }
 else   securityTestLog.addText("SecurityTest finished with status [" + testRunner.getStatus() + "], time taken = "+ securityRunner.getTimeTaken());
  lastRunner=runner;
  runner=null;
  JToggleButton loopButton=(JToggleButton)runContext.getProperty("loopButton");
  if (loopButton != null && loopButton.isSelected() && testRunner.getStatus() == SecurityTestRunner.Status.FINISHED) {
    SwingUtilities.invokeLater(new Runnable(){
      public void run(){
        runSecurityTest();
      }
    }
);
  }
 else {
    SecurityTestDesktopPanel.this.afterRun();
  }
}
