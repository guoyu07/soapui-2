{
  Attachment[] oldData=getData();
  MaliciousAttachmentSecurityCheckConfig copy=(MaliciousAttachmentSecurityCheckConfig)config.copy();
  listModel.clear();
  config.getElementList().clear();
  if (attachments != null) {
    for (    Attachment att : attachments) {
      listModel.addElement(att);
      holder.getGenerateTableModel().clear();
      holder.getReplaceTableModel().clear();
      holder.getTablesDialog().setBooleanValue(MutationTables.REMOVE_FILE,new Boolean(false));
      MaliciousAttachmentElementConfig newElement=config.addNewElement();
      for (      MaliciousAttachmentElementConfig element : copy.getElementList()) {
        if (element.getKey().equals(att.getName())) {
          newElement.setKey(att.getName());
          newElement.setRemove(element.getRemove());
          holder.getTablesDialog().setBooleanValue(MutationTables.REMOVE_FILE,element.getRemove());
          for (          MaliciousAttachmentConfig el : element.getGenerateAttachmentList()) {
            MaliciousAttachmentConfig newEl=newElement.addNewGenerateAttachment();
            newEl.setFilename(el.getFilename());
            newEl.setSize(el.getSize());
            newEl.setContentType(el.getContentType());
            newEl.setEnabled(el.getEnabled());
            newEl.setCached(el.getCached());
            holder.addResultToGenerateTable(newEl);
          }
          for (          MaliciousAttachmentConfig el : element.getReplaceAttachmentList()) {
            MaliciousAttachmentConfig newEl=newElement.addNewReplaceAttachment();
            newEl.setFilename(el.getFilename());
            newEl.setSize(el.getSize());
            newEl.setContentType(el.getContentType());
            newEl.setEnabled(el.getEnabled());
            newEl.setCached(el.getCached());
            holder.addResultToReplaceTable(newEl);
          }
          holder.refresh(att,null);
          break;
        }
      }
    }
    firePropertyChange("attachments",oldData,getData());
  }
}
