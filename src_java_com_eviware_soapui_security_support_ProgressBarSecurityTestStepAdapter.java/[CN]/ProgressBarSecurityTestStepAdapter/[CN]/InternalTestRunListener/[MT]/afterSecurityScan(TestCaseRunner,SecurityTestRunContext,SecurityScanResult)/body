{
  if (securityCheckResult.getSecurityScan().getTestStep().getId().equals(testStep.getId())) {
    if (securityCheckResult.getStatus() == ResultStatus.CANCELED) {
      progressBar.setString(STATE_CANCEL);
      progressBar.setBackground(UNKNOWN_COLOR);
    }
 else     if (securityCheckResult.getStatus() == ResultStatus.FAILED) {
      progressBar.setForeground(FAILED_COLOR);
    }
 else     if (securityCheckResult.getStatus() == ResultStatus.OK) {
      if (!progressBar.getForeground().equals(FAILED_COLOR) && !progressBar.getForeground().equals(MISSING_ASSERTION_COLOR)) {
        progressBar.setForeground(OK_COLOR);
      }
    }
    progressBar.setValue(((SecurityTestRunContext)runContext).getCurrentScanIndex() + 1);
    ((DefaultTreeModel)tree.getModel()).nodeChanged(node);
  }
}
