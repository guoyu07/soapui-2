{
  if (fileChooser == null) {
    fileChooser=new JFileChooser();
  }
  String root=ProjectSettings.PROJECT_ROOT;
  if (StringUtils.hasContent(root)) {
    fileChooser.setCurrentDirectory(new File(root));
  }
  int returnVal=fileChooser.showOpenDialog(UISupport.getMainFrame());
  if (returnVal == JFileChooser.APPROVE_OPTION) {
    File file=fileChooser.getSelectedFile();
    Boolean retval=UISupport.confirmOrCancel("Cache attachment in request?","Add Attachment");
    if (retval == null) {
      return;
    }
    holder.addResultToReplaceTable(file,new MimetypesFileTypeMap().getContentType(file),true,retval);
    for (    MaliciousAttachmentElementConfig element : config.getElementList()) {
      if (element.getKey().equals(holder.getTablesDialog().getValue(MutationTables.SELECTED_FILE))) {
        MaliciousAttachmentConfig maliciousAtt=element.addNewGenerateAttachment();
        AttachmentConfig attachment=maliciousAtt.addNewAttachment();
        maliciousAtt.setEnabled(true);
        attachment.setTempFilename(file.getName());
        attachment.setSize(file.length());
        attachment.setContentType(new MimetypesFileTypeMap().getContentType(file));
      }
    }
  }
}
