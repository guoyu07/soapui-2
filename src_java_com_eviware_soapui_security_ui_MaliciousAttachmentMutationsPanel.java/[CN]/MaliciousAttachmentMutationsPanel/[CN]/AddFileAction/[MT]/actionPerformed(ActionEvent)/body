{
  if (fileChooser == null) {
    fileChooser=new JFileChooser();
  }
  String root=ProjectSettings.PROJECT_ROOT;
  if (StringUtils.hasContent(root)) {
    fileChooser.setCurrentDirectory(new File(root));
  }
  int returnVal=fileChooser.showOpenDialog(UISupport.getMainFrame());
  if (returnVal == JFileChooser.APPROVE_OPTION) {
    File file=fileChooser.getSelectedFile();
    Boolean retval=UISupport.confirmOrCancel("Cache attachment in request?","Add Attachment");
    if (retval == null) {
      return;
    }
    String filename=file.getAbsolutePath();
    Long size=file.length();
    String contentType=new MimetypesFileTypeMap().getContentType(file);
    Boolean enabled=new Boolean(true);
    Boolean cached=retval;
    for (    MaliciousAttachmentElementConfig element : config.getElementList()) {
      if (element.getKey().equals(holder.getTablesDialog().getValue(MutationTables.SELECTED_FILE))) {
        MaliciousAttachmentConfig att=element.addNewReplaceAttachment();
        att.setFilename(filename);
        att.setSize(size);
        att.setContentType(contentType);
        att.setEnabled(enabled);
        att.setCached(cached);
        holder.addResultToReplaceTable(att);
      }
    }
  }
}
