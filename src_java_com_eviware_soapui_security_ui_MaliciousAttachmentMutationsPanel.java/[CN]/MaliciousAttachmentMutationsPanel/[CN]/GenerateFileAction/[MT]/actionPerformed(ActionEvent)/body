{
  if (dialog == null) {
    dialog=ADialogBuilder.buildDialog(GenerateFile.class);
    ((JTextFieldFormField)dialog.getFormField(GenerateFile.CONTENT_TYPE)).setWidth(30);
  }
  dialog.show();
  if (dialog.getReturnValue() == XFormDialog.OK_OPTION) {
    int newSizeInt=0;
    String newSizeString=dialog.getValue(GenerateFile.SIZE);
    String contentType=dialog.getFormField(GenerateFile.CONTENT_TYPE).getValue();
    try {
      newSizeInt=Integer.parseInt(newSizeString) * 1024 * 1024;
    }
 catch (    NumberFormatException nfe) {
      UISupport.showErrorMessage("Size must be integer number");
      return;
    }
    try {
      File rFile=new RandomFile(newSizeInt,"attachment",contentType).next();
      holder.addResultToGenerateTable(rFile,new MimetypesFileTypeMap().getContentType(rFile),true,true);
      for (      MaliciousAttachmentElementConfig element : config.getElementList()) {
        if (element.getKey().equals(holder.getTablesDialog().getValue(MutationTables.SELECTED_FILE))) {
          MaliciousAttachmentConfig maliciousAtt=element.addNewReplaceAttachment();
          AttachmentConfig att=maliciousAtt.addNewAttachment();
          maliciousAtt.setEnabled(true);
          att.setSize(rFile.length());
          att.setContentType(new MimetypesFileTypeMap().getContentType(rFile));
        }
      }
    }
 catch (    Exception e1) {
      UISupport.showErrorMessage(e1);
    }
  }
}
