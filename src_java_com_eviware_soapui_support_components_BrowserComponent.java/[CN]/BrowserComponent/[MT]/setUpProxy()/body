{
  if (isJXBrowserDisabled())   return;
  initialize();
  ProxyConfiguration proxyConf=Services.getProxyConfiguration();
  if (proxyConf == null)   return;
  Settings settings=SoapUI.getSettings();
  PropertyExpansionContext context=null;
  String proxyHost=System.getProperty("http.proxyHost");
  String proxyPort=System.getProperty("http.proxyPort");
  if (proxyHost == null)   proxyHost=PropertyExpander.expandProperties(context,settings.getString(ProxySettings.HOST,""));
  if (proxyPort == null)   proxyPort=PropertyExpander.expandProperties(context,settings.getString(ProxySettings.PORT,""));
  if (!StringUtils.isNullOrEmpty(proxyHost) && !StringUtils.isNullOrEmpty(proxyPort)) {
    proxyConf.setHttpHost(proxyHost);
    proxyConf.setHttpPort(Integer.parseInt(proxyPort));
    String[] excludes=PropertyExpander.expandProperties(context,settings.getString(ProxySettings.EXCLUDES,"")).split(",");
    for (    String url : excludes) {
      proxyConf.setSkipProxyFor(url);
    }
    final String proxyUsername=PropertyExpander.expandProperties(context,settings.getString(ProxySettings.USERNAME,null));
    final String proxyPassword=PropertyExpander.expandProperties(context,settings.getString(ProxySettings.PASSWORD,null));
    if (proxyUsername != null) {
      proxyConf.setPoxyAuthenticationHandler(ProxyServerType.HTTP,new PoxyAuthenticationHandler(){
        /** 
 * manually sets user name and password for proxy server
 */
        public ProxyServerAuthInfo authenticationRequired(){
          return new ProxyServerAuthInfo(proxyUsername,proxyPassword);
        }
      }
);
    }
  }
}
