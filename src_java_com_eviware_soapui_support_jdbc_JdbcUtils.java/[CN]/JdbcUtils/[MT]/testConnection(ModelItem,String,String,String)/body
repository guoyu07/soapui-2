{
  PropertyExpansionContext context=new DefaultPropertyExpansionContext(modelItem);
  String drvr=PropertyExpander.expandProperties(context,driver).trim();
  String connStr=PropertyExpander.expandProperties(context,connectionString).trim();
  String pass=PropertyExpander.expandProperties(context,password).trim();
  if (connStr.contains(PASS_TEMPLATE)) {
    connStr=connStr.replaceFirst(PASS_TEMPLATE,pass);
  }
  try {
    DriverManager.getDriver(connStr);
  }
 catch (  SQLException e) {
    try {
      Class.forName(drvr).newInstance();
    }
 catch (    Exception e1) {
      throw new Exception("Failed to init connection for drvr [" + drvr + "], connectionString ["+ connectionString+ "]");
    }
  }
  return DriverManager.getConnection(connStr);
}
