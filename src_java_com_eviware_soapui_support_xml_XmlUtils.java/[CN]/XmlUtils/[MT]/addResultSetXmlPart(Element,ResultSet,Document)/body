{
  ResultSetMetaData rsmd=rs.getMetaData();
  Element resultSetElement=xmlDocumentResult.createElement("ResultSet");
  resultsElement.appendChild(resultSetElement);
  int colCount=rsmd.getColumnCount();
  while (rs.next()) {
    Element rowElement=xmlDocumentResult.createElement("Row");
    resultsElement.appendChild(rowElement);
    for (int ii=1; ii <= colCount; ii++) {
      String columnName="";
      if (!StringUtils.isNullOrEmpty(rsmd.getTableName(ii))) {
        columnName+=(rsmd.getTableName(ii)).toUpperCase() + ".";
      }
      columnName+=(rsmd.getColumnName(ii)).toUpperCase();
      String value=rs.getString(ii);
      Element node=xmlDocumentResult.createElement(columnName);
      if (!StringUtils.isNullOrEmpty(value)) {
        node.appendChild(xmlDocumentResult.createTextNode(value.toString()));
      }
      rowElement.appendChild(node);
    }
    resultSetElement.appendChild(rowElement);
  }
  return xmlDocumentResult;
}
