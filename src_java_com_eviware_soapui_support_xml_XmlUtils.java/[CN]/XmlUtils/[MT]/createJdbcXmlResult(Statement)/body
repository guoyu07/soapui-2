{
  DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();
  DocumentBuilder builder=factory.newDocumentBuilder();
  org.w3c.dom.Document xmlDocumentResult=builder.newDocument();
  Element resultsElement=xmlDocumentResult.createElement("Results");
  xmlDocumentResult.appendChild(resultsElement);
  if (statement.getResultSet() != null) {
    xmlDocumentResult=addResultSetXmlPart(resultsElement,statement.getResultSet(),xmlDocumentResult);
    while (statement.getMoreResults()) {
      xmlDocumentResult=addResultSetXmlPart(resultsElement,statement.getResultSet(),xmlDocumentResult);
    }
  }
 else {
    Element errorElement=xmlDocumentResult.createElement("UpdateCount");
    errorElement.appendChild(xmlDocumentResult.createTextNode(String.valueOf(statement.getUpdateCount())));
    resultsElement.appendChild(errorElement);
  }
  return xmlDocumentResult;
}
