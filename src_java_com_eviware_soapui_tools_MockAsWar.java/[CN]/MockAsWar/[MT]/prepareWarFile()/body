{
  if (createWarFileSystem()) {
    File fromDir=new File(System.getProperty("soapui.home"),".." + File.separator + "lib");
    JarPackager.copyAllFromTo(fromDir,lib,new FileFilter(){
      public boolean accept(      File pathname){
        return pathname.getName().indexOf("servlet") == -1 && pathname.getName().indexOf("xulrunner") == -1 && pathname.getName().indexOf("Mozilla") == -1 && pathname.getName().indexOf("l2fprod") == -1 && pathname.getName().indexOf("tuxpack") == -1 && pathname.getName().indexOf("winpack") == -1 && pathname.getName().indexOf("rsyntax") == -1 && pathname.getName().indexOf("ActiveQueryBuilder") == -1 && pathname.getName().indexOf("jxbrowser") == -1;
      }
    }
);
    if (includeExt) {
      fromDir=new File(System.getProperty("soapui.home"),"ext");
      JarPackager.copyAllFromTo(fromDir,lib,null);
    }
    File soapUIHome=new File(System.getProperty("soapui.home"));
    String[] mainJar=soapUIHome.list(new FilenameFilter(){
      public boolean accept(      File dir,      String name){
        if (name.toLowerCase().startsWith("soapui") && name.toLowerCase().endsWith(".jar"))         return true;
        return false;
      }
    }
);
    fromDir=new File(System.getProperty("soapui.home"),mainJar[0]);
    JarPackager.copyFileToDir(fromDir,lib);
    JarPackager.copyFileToDir(projectFile,soapuiDir);
    if (settingsFile != null && settingsFile.exists() && settingsFile.isFile())     JarPackager.copyFileToDir(settingsFile,soapuiDir);
    if (includeActions) {
      fromDir=new File(System.getProperty("soapui.ext.actions"));
      JarPackager.copyAllFromTo(fromDir,actionsDir,null);
    }
    if (includeListeners) {
      fromDir=new File(System.getProperty("soapui.ext.listeners"));
      JarPackager.copyAllFromTo(fromDir,listenersDir,null);
    }
    copyWarResource("header_logo.jpg");
    copyWarResource("stylesheet.css");
    return true;
  }
  return false;
}
