{
  final ExtendedPostMethod post=new ExtendedPostMethod();
  post.setURI(new URI(UPLOAD_URI));
  String locationCode=location.getCode();
  BASE64Encoder encoder=new BASE64Encoder();
  String encodedTestSuiteName=encoder.encode(testCase.getTestSuite().getName().getBytes());
  String encodedTestCaseName=encoder.encode(testCase.getName().getBytes());
  File tempProjectFile=saveTemporaryProject(testCase.getTestSuite().getProject());
  byte[] projectFileData=getBytes(tempProjectFile.getAbsolutePath());
  byte[] zipedProjectFileData=zipBytes(testCase.getTestSuite().getProject().getName(),projectFileData);
  String encodedZipedProjectFile=encoder.encode(zipedProjectFileData);
  String projectPassword=testCase.getTestSuite().getProject().getShadowPassword();
  String encodedProjectPassword=encoder.encode(Strings.nullToEmpty(projectPassword).getBytes());
  String keystoreFilePath=SoapUI.getSettings().getString(SSLSettings.KEYSTORE,"");
  byte[] keystoreFileData=getBytes(keystoreFilePath);
  String encodedKeystoreFile=encoder.encode(keystoreFileData);
  String encodedKeystorePassword=encoder.encode(SoapUI.getSettings().getString(SSLSettings.KEYSTORE_PASSWORD,"").getBytes());
  String requestContent=generateUploadRequestXML(locationCode,encodedTestSuiteName,encodedTestCaseName,encodedZipedProjectFile,encodedProjectPassword,encodedKeystoreFile,encodedKeystorePassword);
  byte[] compressedRequestContent=CompressionSupport.compress(CompressionSupport.ALG_GZIP,requestContent.getBytes());
  post.setEntity(new ByteArrayEntity(compressedRequestContent));
  Document responseDocument=makeCall(UPLOAD_URI,requestContent);
  String redirectURL=(String)xpath.evaluate(REDIRECT_URL_XPATH_EXPRESSION,responseDocument,XPathConstants.STRING);
  if (Strings.isNullOrEmpty(redirectURL)) {
    throw new RuntimeException("The RedirectURL element is missing in the response message");
  }
  return redirectURL;
}
